# PRESSCO21 Phase 2 배포 가이드

> 작성일: 2026-02-21
> 대상: 비전공자 관리자 (코딩 지식 없어도 따라할 수 있도록 작성)
> 소요 예상 시간: 약 2~3시간

---

## 📋 이 가이드의 목적

Phase 2 파트너 클래스 플랫폼을 실제 foreverlove.co.kr에 배포하기 위해
**자동으로 처리된 것**과 **관리자가 직접 해야 할 것**을 구분하여 안내합니다.

---

## ✅ 자동 검수 결과 (이미 완료된 것들)

> Playwright 브라우저 자동화 + 코드 정적 분석으로 확인한 항목입니다.

| 항목 | 상태 | 설명 |
|------|------|------|
| 메이크샵 가상태그 형식 | ✅ 정상 | `<!--/user_id/-->` 올바르게 사용 |
| 메이크샵 편집기 호환성 | ✅ 정상 | `var` 전용, `let`/`const` 미사용 |
| XSS 방지 처리 | ✅ 정상 | `escapeHtml`, `sanitizeHtml` 적용 |
| IIFE 격리 패턴 | ✅ 정상 | 전역변수 오염 방지 |
| CSS 스코핑 | ✅ 정상 | `.class-catalog`, `.class-detail`, `.partner-dashboard` |
| 파트너 대시보드 noindex | ✅ 정상 | 검색엔진 차단 설정 |
| 보안 XSS 방어 (URL) | ✅ 정상 | `sanitizeUrl_()` http/https만 허용 |
| 보안 Injection 방어 | ✅ 정상 | `sanitizeClassId()` 영숫자만 허용 |
| TOCTOU 경쟁조건 방지 | ✅ 정상 | LockService 내부 중복 체크 |
| 점수 조작 방지 | ✅ 정상 | 합격 기준 서버 고정 |
| 메인페이지 정상 로드 | ✅ 정상 | Playwright로 실제 접속 확인 |

---

## ⚠️ 자동 검수에서 발견된 문제 (배포 전 반드시 수정 필요)

> 아래 4가지는 **코드가 완성되어 있지만**, 실제 값 입력이 필요한 항목입니다.

| # | 위치 | 문제 | 심각도 |
|---|------|------|--------|
| 1 | `파트너클래스/목록/js.js` 13번 줄 | `YOUR_SCRIPT_ID` placeholder → GAS URL로 교체 필요 | 🔴 Critical |
| 2 | `파트너클래스/상세/js.js` 14번 줄 | `YOUR_SCRIPT_ID` placeholder → GAS URL로 교체 필요 | 🔴 Critical |
| 3 | `파트너클래스/파트너/Index.html` 61번 줄 | `PARTNER_APPLY_FORM` → 실제 Google Forms URL 교체 필요 | 🔴 Critical |
| 4 | `파트너클래스/파트너/Index.html` 353번 줄 | `CLASS_REGISTER_FORM` → 실제 Google Forms URL 교체 필요 | 🔴 Critical |

이 가이드의 아래 단계를 따라 하면 모두 해결됩니다.

---

## 🗂️ 전체 배포 순서 (반드시 이 순서대로!)

```
1단계: Google Sheets 스프레드시트 생성
     ↓
2단계: GAS 프로젝트 생성 + 코드 복사
     ↓
3단계: GAS 스크립트 속성 설정
     ↓
4단계: 시트 자동 초기화 실행
     ↓
5단계: GAS 웹 앱 배포
     ↓
6단계: 코드 파일에 GAS URL 입력
     ↓
7단계: Google Forms 생성
     ↓
8단계: 메이크샵에 페이지 등록
     ↓
9단계: 시간 트리거 설정
     ↓
10단계: 테스트
```

---

## 1단계: Google Sheets 스프레드시트 만들기

### 1-1. 스프레드시트 생성

1. [Google Sheets](https://sheets.google.com) 접속 (Google 계정 로그인 필요)
2. 왼쪽 상단 **"+"** 버튼 또는 **"빈 스프레드시트"** 클릭
3. 상단 제목 클릭 → **"PRESSCO21 클래스 플랫폼"** 으로 변경 후 Enter

### 1-2. 스프레드시트 ID 복사

주소창의 URL을 보면:
```
https://docs.google.com/spreadsheets/d/1ABCDefGHIJKLmno123456/edit#gid=0
```
`/d/` 와 `/edit` 사이에 있는 긴 문자열이 **스프레드시트 ID**입니다.
이것을 복사해서 메모장에 저장해 두세요.

---

## 2단계: GAS 프로젝트 만들고 코드 넣기

### 2-1. GAS 접속

1. [Google Apps Script](https://script.google.com) 접속
2. 왼쪽 상단 **"새 프로젝트"** 클릭
3. 상단 "제목 없는 프로젝트" 클릭 → **"PRESSCO21-ClassPlatform"** 입력 후 Enter

### 2-2. 코드 파일 복사

1. 개발자가 준비한 `파트너클래스/class-platform-gas.gs` 파일을 **텍스트 편집기** (메모장 등)로 열기
   - 파일 우클릭 → "연결 프로그램" → "메모장"
2. `Ctrl+A` (전체 선택) → `Ctrl+C` (복사)
3. GAS 편집기에서 기존 내용 (`function myFunction() {}`) 전체 선택 후 삭제
4. `Ctrl+V` (붙여넣기)
5. `Ctrl+S` (저장)

> 💡 **파일이 어디 있나요?**
> 개발자에게 `파트너클래스/class-platform-gas.gs` 파일을 받으세요.
> 현재 이 파일은 약 5,300줄이며, 복사 시 시간이 조금 걸릴 수 있습니다.

---

## 3단계: 스크립트 속성 설정 (중요!)

> 이 단계는 비밀번호와 같은 중요 정보를 넣는 단계입니다.
> 여기에 입력한 값은 코드 밖에 안전하게 저장됩니다.

### 3-1. 설정 메뉴 열기

1. GAS 편집기 왼쪽 메뉴에서 **톱니바퀴 아이콘** (프로젝트 설정) 클릭
2. 페이지 하단으로 스크롤 → **"스크립트 속성"** 섹션 찾기
3. **"속성 추가"** 버튼 클릭

### 3-2. 속성 하나씩 추가

아래 표의 내용을 **한 줄씩** 입력합니다.
"속성 추가"를 클릭할 때마다 입력 칸이 생깁니다.

| 속성 이름 (왼쪽 칸) | 값 (오른쪽 칸) | 어디서 확인하나요? |
|------------------|--------------|----------------|
| `SHOPKEY` | (메이크샵 상점키) | 메이크샵 관리자 → 상점관리 → 오픈 API |
| `LICENSEKEY` | (메이크샵 라이센스키) | 메이크샵 관리자 → 상점관리 → 오픈 API |
| `SPREADSHEET_ID` | (1단계에서 복사한 ID) | 직접 복사 |
| `SHOP_DOMAIN` | `foreverlove.co.kr` | 그대로 입력 |
| `ADMIN_EMAIL` | (관리자 이메일 주소) | 예: jhl9464@naver.com |
| `ADMIN_API_TOKEN` | (임의의 비밀 코드) | 예: `pressco21-secret-2026` (영문+숫자, 20자 이상 권장) |
| `GAS_ENDPOINT` | (5단계 이후 설정) | ← 지금은 비워두고 5단계 후 설정 |

4. 모두 입력 후 **"스크립트 속성 저장"** 클릭

### 3-3. 메이크샵 오픈 API 권한 확인

1. 메이크샵 관리자 로그인
2. **상점관리 → 쇼핑몰구축 → 오픈 API** 메뉴
3. 아래 항목들이 **"허용"** 상태인지 확인:
   - **적립금 처리 (process_reserve)**: 허용 ✅
   - **주문 조회 (search_order)**: 허용 ✅
4. `Shopkey`와 `Licensekey` 값 복사 (3-2단계 입력용)

> ⚠️ **IP 제한이 걸려 있나요?**
> GAS는 Google 서버에서 실행되어 IP가 고정되지 않습니다.
> "IP 허용" 설정이 있다면 **IP 제한을 해제**해야 합니다.

---

## 4단계: 시트 자동 초기화 실행

### 4-1. initSheets 함수 실행

1. GAS 편집기 상단 함수 선택 드롭다운 (기본값: "myFunction")을 클릭
2. 목록에서 **`initSheets`** 선택
3. **"실행"** 버튼 (▶️ 아이콘) 클릭
4. 처음 실행 시 **권한 승인 팝업**이 뜹니다:

```
[권한 검토] 클릭
  → Google 계정 선택
  → "고급" 클릭 (처음에는 숨어 있음)
  → "PRESSCO21-ClassPlatform(으)로 이동(안전하지 않음)" 클릭
  → [허용] 클릭
```

> 💡 "안전하지 않음"이라고 나오는 건 정상입니다.
> 본인이 만든 스크립트이므로 안전하게 허용하면 됩니다.

5. 하단 **"실행 로그"** 탭에서 아래와 같은 메시지 확인:

```
[생성] 시트: 파트너 상세 (컬럼 18개)
[생성] 시트: 클래스 메타 (컬럼 23개)
[생성] 시트: 정산 내역 (컬럼 23개)
[생성] 시트: 파트너 신청 (컬럼 9개)
[생성] 시트: 후기 (컬럼 12개)
[생성] 시트: 주문 처리 로그 (컬럼 6개)
[생성] 시트: 이메일 발송 로그 (컬럼 6개)
[생성] 시트: 시스템 설정 (컬럼 3개)
[완료] 시트 초기화 완료
```

### 4-2. 설정 확인

1. 함수 드롭다운에서 **`checkConfig`** 선택 → 실행
2. 로그에서 모든 항목이 `[OK]`인지 확인

```
[OK] SHOPKEY 설정됨
[OK] LICENSEKEY 설정됨
[OK] SPREADSHEET_ID 설정됨
...
```

`[누락]`이 있으면 3단계로 돌아가서 해당 속성을 추가하세요.

---

## 5단계: GAS 웹 앱 배포

### 5-1. 배포 시작

1. GAS 편집기 상단 메뉴 → **"배포"** → **"새 배포"** 클릭
2. **배포 유형** 선택: **"웹 앱"** 클릭 (톱니바퀴 아이콘 옆)
3. 설정 내용:

| 항목 | 선택값 |
|------|------|
| 설명 | PRESSCO21 클래스 플랫폼 v1 |
| 다음 사용자로 실행 | **나** (본인 계정) |
| 액세스 권한 | **모든 사용자** |

4. **"배포"** 클릭

### 5-2. 배포 URL 복사

배포 완료 후 팝업에서:
```
배포 ID: AKfycbXXXXXXXXXXXXXXX
웹 앱 URL: https://script.google.com/macros/s/AKfycbXXXX.../exec
```

**"웹 앱 URL"** 전체를 복사해서 메모장에 저장합니다.

### 5-3. GAS_ENDPOINT 속성 업데이트

1. 좌측 **톱니바퀴** → **스크립트 속성**
2. `GAS_ENDPOINT` 항목 값에 위에서 복사한 URL 입력
3. **"스크립트 속성 저장"**

### 5-4. 배포 확인

브라우저 주소창에 아래 URL 입력 후 Enter:
```
(복사한 URL)?action=health
```

아래와 같이 나오면 성공:
```json
{"success": true, "status": "ok", "timestamp": "2026-02-21 15:30:00"}
```

---

## 6단계: 코드 파일에 GAS URL 입력

> 이 단계에서는 `파트너클래스/` 폴더 안의 파일 2개를 수정합니다.

### 6-1. 목록 페이지 JS 수정

**파일**: `파트너클래스/목록/js.js`

1. 파일을 텍스트 편집기(메모장)로 열기
2. `Ctrl+H` (찾기/바꾸기 열기)
3. 찾기: `https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec`
4. 바꾸기: 5단계에서 복사한 실제 GAS URL 붙여넣기
5. **"모두 바꾸기"** 클릭
6. `Ctrl+S` 저장

### 6-2. 상세 페이지 JS 수정

**파일**: `파트너클래스/상세/js.js`

위 6-1과 동일한 방법으로 `YOUR_SCRIPT_ID`를 실제 GAS URL로 교체합니다.

### 6-3. 전역 변수 설정 (파트너 대시보드 + 메인페이지용)

파트너 대시보드와 메인페이지 인기 클래스 섹션은 **메이크샵 공통 JS**에 전역 변수를 추가해야 합니다.

1. 메이크샵 관리자 로그인
2. **쇼핑몰구축 → HTML/CSS 편집 → 공통 JS 편집** (또는 `전체 디자인 → 코드 직접 편집`)
3. JS 파일 최상단에 아래 코드 추가:

```javascript
// PRESSCO21 GAS 엔드포인트 (전역 설정)
window.PRESSCO21_GAS_URL = '(5단계 GAS URL 붙여넣기)';
```

예시:
```javascript
window.PRESSCO21_GAS_URL = 'https://script.google.com/macros/s/AKfycbXXXX.../exec';
```

4. 저장

---

## 7단계: Google Forms 만들기

> 파트너 신청 폼과 강의 등록 신청 폼 2개를 만들어야 합니다.

### 7-1. 파트너 신청 폼 만들기

1. [Google Forms](https://forms.google.com) 접속
2. **"빈 양식"** 클릭
3. 제목: **"PRESSCO21 파트너 신청서"**
4. 아래 질문들 추가:

| 질문 | 유형 | 필수 여부 |
|------|------|--------|
| 메이크샵 회원 아이디 | 단답형 | 필수 |
| 파트너(공방) 이름 | 단답형 | 필수 |
| 담당자 이름 | 단답형 | 필수 |
| 이메일 주소 | 단답형 | 필수 |
| 연락처 | 단답형 | 필수 |
| 활동 지역 | 단답형 | 필수 |
| 포트폴리오 URL | 단답형 | 선택 |
| 인스타그램 URL | 단답형 | 선택 |
| 자기소개 및 클래스 계획 | 장문형 | 필수 |

5. 우측 상단 **"보내기"** → **"링크"** 탭 → URL 복사
6. 복사한 URL을 메모장에 저장

### 7-2. 강의 등록 신청 폼 만들기

1. 새 폼 만들기
2. 제목: **"PRESSCO21 강의 등록 신청서"**
3. 아래 질문들 추가:

| 질문 | 유형 | 필수 여부 |
|------|------|--------|
| 파트너 코드 (PC_YYYYMM_NNN 형식) | 단답형 | 필수 |
| 클래스 이름 | 단답형 | 필수 |
| 카테고리 | 드롭다운 (압화/보존화/캔들/리스/하바리움/레진아트) | 필수 |
| 난이도 | 드롭다운 (입문/초급/중급/고급) | 필수 |
| 클래스 유형 | 드롭다운 (원데이/정기/온라인) | 필수 |
| 가격 (원) | 단답형 | 필수 |
| 소요 시간 (분) | 단답형 | 필수 |
| 최대 수강 인원 | 단답형 | 필수 |
| 진행 지역/장소 | 단답형 | 필수 |
| 클래스 소개 | 장문형 | 필수 |
| 커리큘럼 | 장문형 | 필수 |
| 이미지 업로드 (썸네일) | 파일 업로드 | 선택 |

4. 링크 복사 후 메모장에 저장

### 7-3. 파트너 대시보드 HTML에 Forms URL 입력

**파일**: `파트너클래스/파트너/Index.html`

1. 텍스트 편집기로 파일 열기
2. `Ctrl+H` → 찾기/바꾸기

**첫 번째 교체:**
- 찾기: `https://forms.gle/PARTNER_APPLY_FORM`
- 바꾸기: 7-1에서 복사한 파트너 신청 폼 URL

**두 번째 교체:**
- 찾기: `https://forms.gle/CLASS_REGISTER_FORM`
- 바꾸기: 7-2에서 복사한 강의 등록 신청 폼 URL

3. `Ctrl+S` 저장

---

## 8단계: 메이크샵에 페이지 등록

> 개발한 3개 페이지를 메이크샵 "개별 HTML" 기능으로 등록합니다.

### 8-1. 메이크샵 HTML 편집기 접속

1. 메이크샵 관리자 로그인
2. **쇼핑몰구축 → HTML/CSS 편집 → 개별 HTML** (또는 **스킨 편집**)
3. **"새 페이지 추가"** 클릭

### 8-2. 클래스 목록 페이지 등록

| 항목 | 입력값 |
|------|------|
| 페이지 ID / 파일명 | `class-list` |
| 페이지 제목 | 파트너 클래스 목록 |
| HTML 내용 | `파트너클래스/목록/Index.html` 전체 내용 붙여넣기 |
| CSS | `파트너클래스/목록/css.css` 전체 내용 붙여넣기 |
| JS | `파트너클래스/목록/js.js` 전체 내용 붙여넣기 |

저장 후 URL 확인: `https://foreverlove.co.kr/shop/page.html?id=class-list`

### 8-3. 클래스 상세 페이지 등록

| 항목 | 입력값 |
|------|------|
| 페이지 ID / 파일명 | `class-detail` |
| 페이지 제목 | 클래스 상세 |
| HTML 내용 | `파트너클래스/상세/Index.html` 전체 내용 붙여넣기 |
| CSS | `파트너클래스/상세/css.css` 전체 내용 붙여넣기 |
| JS | `파트너클래스/상세/js.js` 전체 내용 붙여넣기 |

저장 후 URL 확인: `https://foreverlove.co.kr/shop/page.html?id=class-detail`

### 8-4. 파트너 대시보드 페이지 등록

| 항목 | 입력값 |
|------|------|
| 페이지 ID / 파일명 | `partner-dashboard` |
| 페이지 제목 | 파트너 대시보드 |
| HTML 내용 | `파트너클래스/파트너/Index.html` 전체 내용 붙여넣기 |
| CSS | `파트너클래스/파트너/css.css` 전체 내용 붙여넣기 |
| JS | `파트너클래스/파트너/js.js` 전체 내용 붙여넣기 |

저장 후 URL 확인: `https://foreverlove.co.kr/shop/page.html?id=partner-dashboard`

### 8-5. 메이크샵 저장 시 자주 발생하는 에러

> ❌ **"데이터 수정 실패"** 에러가 나면?

이 에러는 코드 안에 메이크샵이 오해하는 문자가 있을 때 발생합니다.
개발자가 이미 처리해 두었지만, 만약 발생하면:

1. 개발자에게 연락하거나
2. 아래 문자들이 코드에 있는지 확인:
   - `${변수명}` 형태 → `\${변수명}` 으로 되어야 함
   - `let `, `const ` → `var ` 로 되어야 함

---

## 9단계: 시간 트리거 설정

> 주문 감지, 이메일 자동 발송이 자동으로 돌아가도록 설정합니다.

### 9-1. 트리거 메뉴 열기

1. GAS 편집기 왼쪽 메뉴 → **시계 아이콘** (트리거) 클릭
2. 오른쪽 하단 **"트리거 추가"** 버튼 클릭

### 9-2. 트리거 4개 설정

**트리거 1: 주문 폴링 (10분마다)**

| 항목 | 선택값 |
|------|------|
| 실행할 함수 | `triggerPollOrders` |
| 배포 | 헤드 |
| 이벤트 소스 | 시간 기반 |
| 시간 기반 유형 | 분 타이머 |
| 간격 | 10분마다 |

→ 저장

**트리거 2: 리마인더 이메일 (매일 오전 9시)**

| 항목 | 선택값 |
|------|------|
| 실행할 함수 | `triggerSendReminders` |
| 이벤트 소스 | 시간 기반 |
| 시간 기반 유형 | 일 타이머 |
| 시간 | 오전 9시~10시 |

→ 저장

**트리거 3: 후기 요청 이메일 (매일 오전 10시)**

| 항목 | 선택값 |
|------|------|
| 실행할 함수 | `triggerSendReviewRequests` |
| 이벤트 소스 | 시간 기반 |
| 시간 기반 유형 | 일 타이머 |
| 시간 | 오전 10시~11시 |

→ 저장

**트리거 4: 정합성 검증 (매일 자정)**

| 항목 | 선택값 |
|------|------|
| 실행할 함수 | `triggerReconciliation` |
| 이벤트 소스 | 시간 기반 |
| 시간 기반 유형 | 일 타이머 |
| 시간 | 자정~오전 1시 |

→ 저장

---

## 10단계: 테스트 (배포 후 필수 확인)

### 10-1. GAS API 테스트

브라우저 주소창에 직접 입력하여 확인합니다.

**① 헬스 체크:**
```
(GAS URL)?action=health
```
기대 결과: `{"success":true,"status":"ok",...}`

**② 클래스 목록 (빈 결과 정상):**
```
(GAS URL)?action=getClasses
```
기대 결과: `{"success":true,"data":[],...}` (아직 클래스가 없으면 빈 배열)

**③ 카테고리 목록:**
```
(GAS URL)?action=getCategories
```
기대 결과: `{"success":true,"data":[...],...}`

### 10-2. 페이지 직접 접속 테스트

| 페이지 | URL | 기대 결과 |
|--------|-----|----------|
| 클래스 목록 | `foreverlove.co.kr/shop/page.html?id=class-list` | 빈 목록 화면 표시 (스켈레톤 → 빈 결과) |
| 클래스 상세 | `foreverlove.co.kr/shop/page.html?id=class-detail` | 에러 화면 표시 (class_id 없으면 정상) |
| 파트너 대시보드 | `foreverlove.co.kr/shop/page.html?id=partner-dashboard` | 로그인 안내 화면 |

### 10-3. 첫 테스트 데이터 입력

Google Sheets "파트너 상세" 시트에 테스트 파트너 등록:

| 열 이름 | 입력값 |
|--------|------|
| A (partner_code) | `PC_202602_001` |
| B (member_id) | 테스트할 메이크샵 회원 ID |
| C (partner_name) | `테스트 공방` |
| D (grade) | `SILVER` |
| E (email) | 테스트 이메일 |
| F (phone) | `010-1234-5678` |
| G (location) | `서울 강남` |
| H (commission_rate) | `0.10` |
| I (reserve_rate) | `1.00` |
| J (class_count) | `0` |
| K (avg_rating) | `0` |
| L (education_completed) | `TRUE` |
| Q (status) | `active` |

"클래스 메타" 시트에 테스트 클래스 등록:

| 열 이름 | 입력값 |
|--------|------|
| A (class_id) | `CLS001` |
| B (makeshop_product_id) | 메이크샵 상품 branduid |
| C (partner_code) | `PC_202602_001` |
| D (class_name) | `압화 원데이 클래스` |
| E (category) | `압화` |
| F (level) | `beginner` |
| G (price) | `55000` |
| H (duration_min) | `120` |
| I (max_students) | `8` |
| J (description) | `압화 입문 클래스입니다.` |
| T (status) | `active` |

### 10-4. 파트너 인증 테스트

위 테스트 데이터 입력 후:
```
(GAS URL)?action=getPartnerAuth&member_id=(테스트 회원 ID)
```

기대 결과:
```json
{"success": true, "data": {"is_partner": true, "partner_name": "테스트 공방", "grade": "SILVER", ...}}
```

### 10-5. 파트너 대시보드 테스트

1. 테스트 파트너 계정으로 foreverlove.co.kr 로그인
2. `foreverlove.co.kr/shop/page.html?id=partner-dashboard` 접속
3. 기대 결과: 파트너 대시보드 화면 표시 (4개 탭 확인)

---

## 📌 운영 중 자주 발생하는 상황과 해결법

### 상황 1: "적립금 지급 실패 알림" 이메일 수신

1. Google Sheets → "정산 내역" 시트
2. `status` 열이 `FAILED`인 행 확인
3. `error_message` 열에서 원인 파악
4. GAS 편집기 → 함수 선택 → `retryFailedSettlements` → 실행
5. 재시도 후 `status`가 `COMPLETED`로 바뀌었는지 확인

### 상황 2: "일일 이메일 70건 도달" 알림

- 무료 Gmail: 하루 100건 한도
- 70건 도달 시 자동 경고 발송
- **해결**: Google Workspace Starter 전환 (약 8,000원/월, 1,500건/일)

### 상황 3: GAS 코드 수정 후 적용이 안 됨

1. GAS 편집기 → 상단 **"배포"** → **"배포 관리"**
2. 편집 아이콘 클릭
3. **버전을 "새 버전"** 으로 변경
4. **"배포"** 클릭

> ⚠️ "새 버전"을 선택하지 않으면 이전 코드가 계속 실행됩니다!

### 상황 4: 파트너 신청이 GAS에 안 들어옴

- Google Forms 응답은 Sheets에 자동 저장됩니다
- GAS는 "파트너 신청" 시트를 직접 읽습니다
- Forms → Sheets 연결이 되어 있는지 확인:
  - Google Forms → 응답 탭 → Sheets 아이콘 클릭 → 연결된 시트 확인

### 상황 5: 파트너 승인하기

1. Google Sheets → "파트너 신청" 시트
2. 승인할 신청의 `status` 열을 `approved` 로 변경
3. GAS 편집기 → `partnerApprove` 함수 실행 (또는 관리자 API로 호출)
4. 승인된 파트너는 자동으로 "파트너 상세" 시트에 등록됨

---

## 🔍 검수 완료 항목 체크리스트

> 배포 후 이 목록을 하나씩 체크하세요.

### 환경 설정

- [ ] GAS 스크립트 속성 7개 모두 입력 완료
- [ ] `checkConfig` 함수 실행 → 모두 `[OK]`
- [ ] 메이크샵 오픈 API 권한 (적립금, 주문조회) 허용
- [ ] Google Sheets 8개 시트 생성 완료
- [ ] GAS 웹 앱 배포 완료 (`?action=health` 응답 확인)

### 코드 파일

- [ ] `파트너클래스/목록/js.js` GAS URL 교체 완료
- [ ] `파트너클래스/상세/js.js` GAS URL 교체 완료
- [ ] 메이크샵 공통 JS에 `window.PRESSCO21_GAS_URL` 설정 완료
- [ ] `파트너클래스/파트너/Index.html` 파트너 신청 Forms URL 교체 완료
- [ ] `파트너클래스/파트너/Index.html` 강의 등록 Forms URL 교체 완료

### 메이크샵 페이지

- [ ] 클래스 목록 페이지 (`class-list`) 등록 및 접속 확인
- [ ] 클래스 상세 페이지 (`class-detail`) 등록 및 접속 확인
- [ ] 파트너 대시보드 (`partner-dashboard`) 등록 및 접속 확인

### 기능 테스트

- [ ] GAS `?action=health` → `{"success":true}` 확인
- [ ] GAS `?action=getClasses` → 정상 응답 확인
- [ ] 목록 페이지 접속 → 로딩 화면 후 빈 결과 표시
- [ ] 테스트 데이터 입력 후 목록에 클래스 카드 표시
- [ ] 클래스 카드 클릭 → 상세 페이지 이동
- [ ] 파트너 계정 로그인 → 대시보드 정상 표시
- [ ] 4개 탭 (내 강의/예약 현황/수익 리포트/후기 관리) 모두 동작

### 자동화

- [ ] 시간 트리거 4개 설정 완료
- [ ] 테스트 주문 후 10분 내 정산 내역 시트에 기록 확인
- [ ] 예약 확인 이메일 수신 확인

---

## ❓ 자주 묻는 질문 (FAQ)

**Q. 메이크샵에 파일을 어떻게 올리나요?**
A. 메이크샵 D4는 HTML/CSS/JS를 편집기에 직접 붙여넣는 방식입니다.
FTP 업로드가 아니라 관리자 페이지의 HTML 편집기에서 작업합니다.

**Q. GAS URL이 바뀌면 어떻게 하나요?**
A. "배포 관리"에서 동일 배포를 수정(새 버전)하면 URL이 유지됩니다.
"새 배포"를 하면 URL이 바뀌므로 6단계를 다시 해야 합니다.

**Q. 무료 Google 계정으로도 되나요?**
A. 됩니다. 단, 하루 이메일 100건 한도, GAS 실행 6분 제한이 있습니다.
일 100건 이상 예약이 발생하면 Google Workspace로 전환하세요.

**Q. 클래스 사진은 어디에 저장하나요?**
A. Google Sheets 클래스 메타 시트의 `thumbnail_url`, `image_urls` 열에
이미지 URL을 입력합니다. 이미지는 메이크샵 이미지 서버 또는
Google Drive 공개 링크를 사용하세요.

**Q. 파트너가 직접 클래스를 등록할 수 있나요?**
A. 현재는 Google Forms 신청 → 관리자 검토 → Sheets 직접 입력 방식입니다.
추후 Phase 3에서 파트너 직접 등록 기능 추가 예정입니다.

---

## 📞 개발자 문의 필요한 상황

아래 상황이 발생하면 개발자에게 문의하세요:

- GAS 실행 로그에 `INTERNAL_ERROR` 반복 발생
- 메이크샵 편집기 저장 시 계속 "데이터 수정 실패"
- 파트너 인증이 올바른 계정인데 실패
- 이메일이 아예 발송되지 않음 (GAS 로그에도 기록 없음)

---

*이 가이드는 Phase 2 배포를 위한 문서입니다.*
*PRESSCO21 파트너 클래스 플랫폼 v1.0 - 2026-02-21*
