# PRESSCO21 파트너 클래스 수수료/정산 정책 설계서

> **문서 버전**: 1.0
> **작성일**: 2026-02-21
> **담당**: ecommerce-business-expert
> **상태**: Task 201 협업 산출물 (GAS 백엔드 구현 시 본 문서를 기준으로 정산 로직 구현)
> **의존성**: Task 150 (적립금 API Plan A 확정), Task 151 (가상태그 인증 확정), Task 152 (API 예산 확정)

---

## 목차

1. [수수료 정책 상세 설계](#1-수수료-정책-상세-설계)
2. [등급 승급/강등 조건 정밀화](#2-등급-승급강등-조건-정밀화)
3. [정산 타이밍 설계](#3-정산-타이밍-설계)
4. [환불 정책 설계](#4-환불-정책-설계)
5. [KPI 설계](#5-kpi-설계)
6. [파트너 온보딩 인센티브](#6-파트너-온보딩-인센티브)
7. [구현 참조 (GAS/Sheets 매핑)](#7-구현-참조-gassheets-매핑)

---

## 1. 수수료 정책 상세 설계

### 1.1 등급별 수수료 구조

| 등급 | 수수료율 | 적립금 전환율 | PRESSCO21 현금 수익 | 파트너 현금 수령 | 파트너 적립금 |
|------|---------|-------------|-------------------|----------------|-------------|
| SILVER | 10% | 100% | 0% | 90% | 10% |
| GOLD | 12% | 80% | 2.4% | 88% | 9.6% |
| PLATINUM | 15% | 60% | 6% | 85% | 9% |

**수수료 흐름 정리**

```
고객 결제 100%
  |
  +-- 파트너 수령: (100% - 수수료율)
  |     예) SILVER: 90%, GOLD: 88%, PLATINUM: 85%
  |
  +-- 수수료: 수수료율 만큼
        |
        +-- 적립금 전환: 수수료 x 전환율
        |     예) SILVER: 10% x 100% = 10% (전액 적립금)
        |     예) GOLD: 12% x 80% = 9.6% (적립금)
        |     예) PLATINUM: 15% x 60% = 9% (적립금)
        |
        +-- PRESSCO21 현금 수익: 수수료 x (1 - 전환율)
              예) SILVER: 10% x 0% = 0% (성장 지원)
              예) GOLD: 12% x 20% = 2.4%
              예) PLATINUM: 15% x 40% = 6%
```

**SILVER 등급에서 PRESSCO21 현금 수익이 0%인 이유:**

신규 파트너의 성장을 우선 지원한다. 수수료 전액이 적립금으로 전환되어 파트너가 재료를 구매하면, 그 구매 자체가 PRESSCO21의 매출이 된다. 즉, 직접 수수료 수익 대신 재료 매출로 간접 수익을 확보하는 구조다. 파트너가 성장하여 GOLD/PLATINUM으로 승급하면 비로소 직접 현금 수익이 발생한다.

### 1.2 수수료 계산 예시

#### 예시 1: SILVER 등급 파트너 - 원데이 클래스 1건

```
클래스: 압화 에코백 원데이 클래스
수강료: 45,000원/인
수강 인원: 6명
매출: 45,000 x 6 = 270,000원

수수료 (10%): 27,000원
  적립금 전환 (100%): 27,000원
  PRESSCO21 현금: 0원

파트너 현금 수령: 270,000 - 27,000 = 243,000원
파트너 적립금 지급: 27,000원

파트너 총 수취 가치: 243,000 + 27,000 = 270,000원
(적립금은 재료 구매 시 현금과 동일하게 사용 가능)
```

#### 예시 2: GOLD 등급 파트너 - 월 4회 운영

```
클래스: 보존화 꽃다발 클래스
수강료: 55,000원/인
수강 인원: 평균 8명/회
월 횟수: 4회
월 매출: 55,000 x 8 x 4 = 1,760,000원

수수료 (12%): 211,200원
  적립금 전환 (80%): 168,960원
  PRESSCO21 현금: 42,240원

파트너 현금 수령: 1,760,000 - 211,200 = 1,548,800원
파트너 적립금 지급: 168,960원

파트너 재료비: 약 500,000원/월
적립금으로 재료비 충당: 168,960원 (33.8%)
실제 재료비 지출: 331,040원

파트너 순이익 (공간비 300,000원 제외):
  1,548,800 - 331,040 - 300,000 = 917,760원/월
```

#### 예시 3: PLATINUM 등급 파트너 - 월 8회 고빈도 운영

```
클래스: 레진 트레이 + 압화 액자 (2종)
수강료: 평균 60,000원/인
수강 인원: 평균 10명/회
월 횟수: 8회
월 매출: 60,000 x 10 x 8 = 4,800,000원

수수료 (15%): 720,000원
  적립금 전환 (60%): 432,000원
  PRESSCO21 현금: 288,000원

파트너 현금 수령: 4,800,000 - 720,000 = 4,080,000원
파트너 적립금 지급: 432,000원

파트너 재료비: 약 1,200,000원/월
적립금으로 재료비 충당: 432,000원 (36%)
실제 재료비 지출: 768,000원

파트너 순이익 (공간비 500,000원, 조교비 400,000원 제외):
  4,080,000 - 768,000 - 500,000 - 400,000 = 2,412,000원/월
```

#### 예시 4: 소규모 파트너 - 월 2회 운영

```
클래스: 하바리움 입문
수강료: 35,000원/인
수강 인원: 평균 5명/회
월 횟수: 2회
월 매출: 35,000 x 5 x 2 = 350,000원

수수료 (10%): 35,000원
  적립금 전환 (100%): 35,000원

파트너 현금 수령: 315,000원
파트너 적립금 지급: 35,000원

재료비: 약 100,000원
적립금 활용: 35,000원 -> 실 재료비 65,000원

파트너 순이익 (자택 공방, 공간비 0원):
  315,000 - 65,000 = 250,000원/월
```

### 1.3 타 플랫폼 대비 수수료 비교

| 플랫폼 | 수수료율 | 적립금/환급 | 파트너 실수령 | 비고 |
|--------|---------|-----------|-------------|------|
| 클래스101 | 30~40% | 없음 | 60~70% | 온라인 강의 중심 |
| 탈잉 | 20~30% | 없음 | 70~80% | 오프라인 포함 |
| 프립 | 15~20% | 없음 | 80~85% | 오프라인 체험 중심 |
| 아이디어스 (클래스) | 15~20% | 없음 | 80~85% | 핸드메이드 중심 |
| 네이버 스마트스토어 (체험) | 5~10% | 없음 | 90~95% | 플랫폼 노출 제한적 |
| **PRESSCO21 SILVER** | **10%** | **전액 적립금** | **90% + 10% 적립금** | **실질 100%** |
| **PRESSCO21 GOLD** | **12%** | **80% 적립금** | **88% + 9.6% 적립금** | **실질 97.6%** |
| **PRESSCO21 PLATINUM** | **15%** | **60% 적립금** | **85% + 9% 적립금** | **실질 94%** |

**PRESSCO21의 차별점:**

1. **수수료가 돌아온다**: 다른 플랫폼은 수수료가 사라지지만, PRESSCO21은 적립금으로 돌아온다
2. **재료 구매에 사용 가능**: 적립금으로 재료를 도매가에 구매 -> 재료비 절감 효과
3. **실질 파트너 부담**: SILVER 등급은 수수료 전액이 적립금이므로 실질 수수료 0%
4. **니치 시장 전문성**: 압화/보존화/레진 특화 -> 타 플랫폼에 없는 전문 수강생 유입

### 1.4 적립금 전환의 선순환 효과

```
[선순환 사이클]

파트너 클래스 운영
     |
     v
수강료 매출 발생
     |
     v
수수료 적립금 전환
     |
     +-- 재료 구매 (도매가) ---------> PRESSCO21 매출 발생
     |                                    |
     +-- 광고 부스트 신청 ------+        v
     |                         |    추가 재료 매출
     +-- 신상품 샘플 체험 ---+  |        |
     |                      |  |        v
     v                      v  v   더 많은 수강생 유입
  새 클래스 개발          노출 증가      |
     |                      |           v
     +------+               |      수강료 매출 증가
             |               |           |
             v               v           v
         클래스 다양화   수강생 증가   수수료 적립금 증가
                    |                    |
                    +------+------+------+
                           |
                           v
                    [선순환 확대]
```

**적립금 사용처별 예상 비중 (Phase 2 기준):**

| 사용처 | 예상 비중 | PRESSCO21 효과 | 우선순위 |
|--------|---------|---------------|---------|
| 재료 구매 (도매가) | 60% | 직접 매출 | 1순위 |
| 광고 부스트 (노출 증가) | 20% | 수강생 유입 | 2순위 |
| 신상품 샘플 | 10% | 새 클래스 -> 매출 다변화 | 3순위 |
| 계절 프로모션 참여 | 10% | 시즌 매출 증가 | 4순위 |

**적립금 환류 시뮬레이션 (Phase 2 목표 기준, 월 50건):**

```
월 매출: 50건 x 평균 45,000원 = 2,250,000원
평균 수수료율: ~10.5% (대부분 SILVER)
수수료 총액: 236,250원
적립금 전환: ~230,000원 (전환율 97%)
적립금 중 재료 구매: ~138,000원 (60%)
적립금 중 광고: ~46,000원 (20%)
적립금 중 기타: ~46,000원 (20%)

PRESSCO21 간접 수익:
  재료 매출 138,000원 x 마진율 40% = 55,200원
  광고 수익: 46,000원 (전액)
  합계: ~101,200원/월
```

---

## 2. 등급 승급/강등 조건 정밀화

### 2.1 등급 체계 정의

| 등급 | 영문명 | 아이콘 | 수수료 | 적립금 전환 | 승급 조건 |
|------|--------|--------|--------|-----------|----------|
| SILVER | Silver Partner | 은색 배지 | 10% | 100% | 가입 + 필수 교육 이수 |
| GOLD | Gold Partner | 금색 배지 | 12% | 80% | 수강 완료 10건+ AND 평점 4.0+ |
| PLATINUM | Platinum Partner | 플래티넘 배지 | 15% | 60% | 수강 완료 50건+ AND 평점 4.5+ |

### 2.2 SILVER -> GOLD 자동 승급

**승급 조건:**

| 항목 | 기준값 | 산정 기간 | 비고 |
|------|-------|----------|------|
| 누적 수강 완료 건수 | 10건 이상 | 가입 후 전체 기간 | 환불/취소 건은 제외 |
| 평균 수강생 평점 | 4.0 이상 (5점 만점) | 가입 후 전체 기간 | 최소 5건 이상 리뷰 기준 |
| 필수 교육 이수 | 완료 | - | SILVER 가입 시 이미 이수 |
| 환불률 | 15% 미만 | 최근 6개월 | 환불 건수 / 총 예약 건수 |

**검증 시점:**

- **실시간 검증**: 수강 완료 기록이 Sheets에 등록될 때마다 자동 체크
- **구현 방식**: GAS `pollNewOrders()` 함수에서 주문 처리 후, 해당 파트너의 누적 데이터를 계산하여 승급 조건 충족 여부 확인
- **승급 반영**: 조건 충족 시 즉시 Sheets "파트너 상세" 시트의 등급 컬럼 업데이트
- **수수료 적용**: 승급일 다음 달 1일부터 새 수수료율 적용 (월 중간 변경 없음)

**승급 프로세스 (GAS 의사 코드):**

```
FUNCTION checkGradeUpgrade(partnerId):
    partner = getPartnerDetail(partnerId)
    IF partner.grade == 'SILVER':
        completedClasses = countCompletedClasses(partnerId)
        avgRating = getAverageRating(partnerId)
        reviewCount = countReviews(partnerId)
        refundRate = calculateRefundRate(partnerId, 6)  // 최근 6개월

        IF completedClasses >= 10
           AND avgRating >= 4.0
           AND reviewCount >= 5
           AND refundRate < 0.15:
            scheduleGradeChange(partnerId, 'GOLD', nextMonthFirstDay())
            sendGradeUpgradeNotification(partnerId, 'GOLD')
```

### 2.3 GOLD -> PLATINUM 자동 승급

**승급 조건:**

| 항목 | 기준값 | 산정 기간 | 비고 |
|------|-------|----------|------|
| 누적 수강 완료 건수 | 50건 이상 | 가입 후 전체 기간 | |
| 평균 수강생 평점 | 4.5 이상 (5점 만점) | 가입 후 전체 기간 | 최소 20건 이상 리뷰 기준 |
| 월 평균 매출 | 200만원 이상 | 최근 3개월 평균 | 안정적 운영 확인 |
| 환불률 | 10% 미만 | 최근 6개월 | |
| 심화 교육 이수 | 완료 | - | GOLD 승급 후 심화 교육 필수 |

**검증 시점:** GOLD 승급과 동일한 방식 (수강 완료 기록 시 자동 체크)

### 2.4 등급 강등 조건

**강등은 자동이 아닌 경고 -> 유예 -> 강등 3단계로 진행한다.**

#### 강등 트리거 조건

| 현재 등급 | 강등 트리거 | 유예 기간 | 강등 대상 등급 |
|----------|-----------|----------|-------------|
| GOLD | 최근 3개월 평점 3.5 미만 | 2개월 | SILVER |
| GOLD | 최근 6개월 환불률 20% 이상 | 1개월 | SILVER |
| GOLD | 6개월 연속 수강 완료 0건 (휴면) | 1개월 | SILVER |
| PLATINUM | 최근 3개월 평점 4.0 미만 | 2개월 | GOLD |
| PLATINUM | 최근 6개월 환불률 15% 이상 | 1개월 | GOLD |
| PLATINUM | 최근 3개월 월 평균 매출 100만원 미만 | 3개월 | GOLD |

#### 강등 프로세스

```
1단계: 경고 알림 (트리거 발생 시)
  - 파트너에게 이메일 발송
  - 내용: "현재 [지표]가 [기준] 미만입니다. [유예기간] 이내 개선이 없으면
          등급이 [현재등급]에서 [대상등급]으로 변경될 수 있습니다."
  - Sheets "등급경고" 시트에 기록

2단계: 유예 기간 중 재검증 (유예기간 50% 경과 시)
  - 지표 재측정
  - 개선 시: 경고 해제, 파트너에게 "경고 해제" 이메일
  - 미개선 시: 2차 경고 이메일 ("유예 기간 [N]일 남음")

3단계: 강등 실행 (유예 기간 만료 시)
  - 지표 최종 측정
  - 여전히 미달 시: 등급 변경 + 파트너 이메일
  - 수수료율 변경: 다음 달 1일부터 적용
  - 개선 시: 경고 해제
```

#### 강등 시 수수료율 변경 규칙

- 강등 확정일: 유예 기간 마지막 날
- 새 수수료율 적용: 강등 확정일 다음 달 1일
- 이미 진행 중인 클래스: 현재 수수료율 유지 (진행 중 변경 없음)
- Sheets "파트너 상세" 시트에 등급 변경 이력 기록

### 2.5 등급 변경 알림 방법

| 이벤트 | 발송 시점 | 채널 | 내용 |
|--------|----------|------|------|
| 승급 예정 | 조건 충족 시 즉시 | 이메일 | "축하합니다! [등급]으로 승급됩니다. 다음 달 1일부터 적용됩니다." |
| 승급 확정 | 적용 당일 (매월 1일) | 이메일 | "오늘부터 [등급] 파트너입니다. 새로운 수수료율은 [N]%입니다." |
| 강등 경고 | 트리거 발생 시 | 이메일 | "경고: [지표] 미달. [유예기간] 이내 개선 필요." |
| 강등 2차 경고 | 유예기간 50% | 이메일 | "유예기간 [N]일 남음. 현재 지표: [값]" |
| 강등 확정 | 유예기간 만료 | 이메일 | "등급 변경: [이전] -> [이후]. 다음 달 1일부터 적용." |
| 강등 후 재승급 | 재승급 조건 충족 시 | 이메일 | "축하합니다! 다시 [등급]으로 승급됩니다." |

**이메일 템플릿은 GAS MailApp으로 발송하며, Task 221 (정산 자동화)에서 구현한다.**

### 2.6 등급별 추가 혜택

| 혜택 | SILVER | GOLD | PLATINUM |
|------|--------|------|----------|
| 수수료율 | 10% | 12% | 15% |
| 적립금 전환율 | 100% | 80% | 60% |
| 재료 할인율 (도매가) | 기본가 | 5% 추가 할인 | 10% 추가 할인 |
| 클래스 목록 노출 순위 | 기본 | 우선 노출 (+10) | 최우선 노출 (+20) |
| 메인페이지 노출 | - | 분기 1회 | 상시 |
| 신상품 사전 체험 | - | 출시 후 1주 | 출시 전 2주 |
| 전용 고객 지원 | 일반 | 우선 응대 | 전담 매니저 |
| 파트너맵 배지 | 기본 | GOLD 배지 | PLATINUM 배지 |

---

## 3. 정산 타이밍 설계

### 3.1 옵션 비교

| 옵션 | 시점 | 장점 | 단점 | 리스크 |
|------|------|------|------|--------|
| A. 결제 즉시 | 결제 완료 시점 | 빠른 적립금 지급 | 환불 시 적립금 회수 복잡 | 높음 |
| B. 수업 당일 (D-day) | 수업일 00:00 | 중간 수준 | 노쇼 시 처리 불명확 | 중간 |
| **C. 수업 완료 +3일** | **수업일 + 3 영업일** | **환불 방지, 안전** | **파트너 지급 지연** | **낮음** |
| D. 월말 일괄 | 매월 말일 | 정산 단순 | 파트너 불만 (지급 지연) | 낮음 |

### 3.2 권장 옵션: C. 수업 완료 +3일 (D+3)

**선택 이유:**

1. **환불 방지 안전 장치**: 수업 완료 후 3일간 환불/불만 접수 기간을 확보
2. **노쇼 처리 가능**: 수업일까지 실제 수강 여부를 확인한 후 정산
3. **적립금 API 안정성**: 즉시 지급 시 환불로 인한 이중 처리 방지
4. **타 플랫폼 관행**: 프립, 클래스101 등도 수업 완료 후 정산이 표준

**예외 사항:**

| 상황 | 처리 방법 |
|------|----------|
| 수업 정상 완료 | D+3 자동 적립금 지급 |
| 수업 당일 노쇼 (수강생 미참석) | 파트너에게 정상 정산 (수강생 귀책) |
| 수업 취소 (파트너 귀책) | 수강생 전액 환불, 파트너 정산 없음 |
| 수업 후 3일 이내 불만 접수 | 관리자 판단 후 정산 보류/진행 결정 |

### 3.3 정산 플로우 상세

```
[결제 시점 (D-N)]
  1. 고객이 클래스 결제 (메이크샵 네이티브 결제)
  2. GAS 주문 폴링 (10분 간격)으로 새 주문 감지
  3. Sheets "예약 내역" 시트에 기록 (정산 상태: "예약확정")
  4. 수강생/파트너에게 예약 확인 이메일 발송
  5. 수수료 계산 -> Sheets "정산 내역" 시트에 예정 기록 (정산 상태: "대기")

[수업 전 리마인더]
  6. D-3: 리마인더 이메일 (수강생 + 파트너)
  7. D-1: 리마인더 이메일 (수강생 + 파트너)

[수업 당일 (D-day)]
  8. 파트너가 수강 완료 확인 (대시보드에서 "수강 완료" 버튼 클릭)
     - 또는 D+1에 자동 완료 처리 (파트너 미확인 시)
  9. 정산 상태 변경: "대기" -> "수강완료"

[수업 완료 +3일 (D+3)]
  10. GAS 시간 트리거로 D+3 도달 건 자동 감지
  11. 정산 상태 변경: "수강완료" -> "처리중"
  12. 해당 파트너의 월간 누적 매출 계산
  13. 매출 구간별 수수료율 적용
  14. 수수료 금액 산출
  15. 적립금 전환 비율 적용
  16. 메이크샵 적립금 API (process_reserve) 호출
      - 성공 시: 정산 상태 "완료"
      - 실패 시: 정산 상태 "실패", 관리자 알림 이메일
  17. 파트너에게 정산 완료 이메일
      - 클래스명, 수강인원, 매출, 수수료, 적립금 지급액, 적립금 잔액

[D+7: 후기 유도]
  18. 수강생에게 후기 작성 유도 이메일
```

### 3.4 정산 정확성 보장 규칙

| 규칙 | 내용 | 구현 |
|------|------|------|
| 월 시작일 | 매월 1일 00:00 (KST) | GAS Date 객체 + Asia/Seoul 시간대 |
| 매출 구간 산정 | 해당 월 1일~말일 누적 매출 기준 | Sheets SUMIFS 함수 또는 GAS 계산 |
| 구간 변동 처리 | 초과분에만 새 요율 적용 (누진 방식 아님, 단일 요율) | 아래 상세 설명 참조 |
| 소수점 처리 | 원 단위 반올림 (Math.round) | GAS Math.round() |
| 동시 처리 방지 | GAS LockService.getScriptLock() | waitLock(30000) |
| 정산 상태 | 5단계: 예약확정 -> 대기 -> 수강완료 -> 처리중 -> 완료/실패 | Sheets 상태 컬럼 |

**구간 변동 처리 규칙 (중요):**

수수료율은 **단일 요율 적용** 방식이다. 월 중간에 매출이 구간을 넘으면, 해당 월 전체 매출에 새 구간의 수수료율을 적용한다. 단, 이미 정산 완료된 건은 소급하지 않고, 이후 건부터 새 요율을 적용한다.

```
예시: SILVER 파트너, 월 중간에 50만원 돌파

  월 1일~15일: 매출 45만원 -> 수수료 10% -> 적립금 100% (각 건별 D+3 정산)
  월 16일: 매출 누적 55만원 (50만원 돌파)
  -> 이 시점부터 GOLD 등급 조건 검토 (10건+ AND 4.0+)
  -> GOLD 미충족이면 SILVER 유지 (수수료율 변동 없음)
  -> GOLD 충족이면 다음 달 1일부터 GOLD 수수료 12% 적용
```

**핵심: 수수료율은 등급에 의해 결정되며, 등급 변경은 월 단위로만 적용된다. 월 중간에 수수료율이 바뀌는 일은 없다.**

---

## 4. 환불 정책 설계

### 4.1 수강생 환불 정책

| 취소 시점 | 환불 비율 | 수수료 | 비고 |
|----------|---------|--------|------|
| D-7 이전 | 100% 전액 환불 | 없음 | 자유 취소 |
| D-7 ~ D-4 | 100% 전액 환불 | 없음 | 대체 수강생 모집 여유 |
| D-3 | 80% 환불 | 20% 위약금 | 파트너 재료 준비 고려 |
| D-2 ~ D-1 | 50% 환불 | 50% 위약금 | 재료 이미 준비 |
| D-day (당일) | 환불 불가 | 100% | 노쇼 포함 |
| 수업 후 | 환불 불가 | - | 수강 완료 |

**위약금 배분:**

| 위약금 비율 | 파트너 수령 | PRESSCO21 수령 | 비고 |
|-----------|-----------|--------------|------|
| 20% (D-3) | 15% | 5% | 재료비 보전 |
| 50% (D-2~D-1) | 40% | 10% | 재료+인건비 보전 |
| 100% (당일) | 90% (정상 정산) | 10% (수수료) | 정상 정산과 동일 |

### 4.2 환불 시 적립금 처리 방법

**Case 1: 정산 전 환불 (D+3 이전)**

```
정산 전이므로 적립금이 아직 지급되지 않은 상태.
-> Sheets "정산 내역"에서 해당 건 상태를 "취소"로 변경
-> 파트너 적립금 영향 없음
-> 메이크샵에서 수강생에게 환불 처리 (관리자 수동)
```

**Case 2: 정산 후 환불 (D+3 이후, 예외적 상황)**

```
이미 적립금이 지급된 상태에서 환불이 발생한 경우 (품질 불만 등).
-> 관리자 판단으로 환불 결정
-> 적립금 차감 API 호출 (process_reserve, 음수 금액)
-> Sheets "정산 내역"에 역정산 기록 추가
-> 파트너에게 환불 처리 안내 이메일
-> 파트너 적립금 잔액이 부족하면 다음 달 정산에서 차감
```

**Case 3: 부분 환불**

```
수강인원 3명 중 1명만 환불하는 경우.
-> 해당 1명분 매출에 대해서만 정산 취소/역정산
-> 나머지 2명분은 정상 정산 유지
-> Sheets에 부분 환불 기록 (원본 건 참조)
```

### 4.3 메이크샵 환불 프로세스 연동

메이크샵 자체 환불 기능과 PRESSCO21 정산 시스템 연동 방법:

```
[메이크샵 환불 프로세스]
  1. 수강생이 환불 요청 (전화/메일/게시판)
  2. 관리자가 메이크샵 관리자 > 주문관리에서 환불 처리
     - 취소 시점에 따른 환불 비율 적용
     - PG사를 통한 환불 진행

[PRESSCO21 정산 연동]
  3. GAS 주문 폴링에서 "취소/환불" 상태 주문 감지
     - search_order API에서 order_status = "취소" 필터링
  4. Sheets "예약 내역"에서 해당 주문 상태 변경
  5. 정산 전이면: 정산 건 삭제
  6. 정산 후이면: 역정산 기록 생성 + 적립금 차감 API 호출
  7. 파트너에게 환불 안내 이메일
```

### 4.4 환불 분쟁 처리

| 분쟁 유형 | 1차 처리 | 2차 처리 | 최종 |
|----------|---------|---------|------|
| 수강생 노쇼 | 환불 불가 원칙 고지 | 1회에 한해 50% 크레딧 | 관리자 재량 |
| 강사 불만 | 파트너에게 피드백 전달 | 관리자 중재 후 부분 환불 | 반복 시 등급 강등 |
| 수업 품질 | 수강생 후기 + 파트너 소명 | 관리자 판단 환불 | 패턴 반복 시 파트너 해지 |
| 재료 불량 | PRESSCO21 책임 (전액 환불) | 파트너 정산 유지 | 재료 교환 |
| 일정 변경 (파트너) | 수강생 선택 (날짜변경/환불) | 전액 환불 | 반복 시 경고 |

---

## 5. KPI 설계

### 5.1 파트너 플랫폼 초기 6개월 KPI

#### Phase 2 목표 (1~3개월)

| KPI | 1개월 | 2개월 | 3개월 | 측정 방법 | 주기 |
|-----|-------|-------|-------|----------|------|
| 등록 파트너 | 3명 | 8명 | 15명 | Sheets "파트너 상세" | 월간 |
| 활성 파트너 (월 1회+ 수업) | 3명 | 5명 | 10명 | Sheets "예약 내역" | 월간 |
| 월간 수강 예약 | 10건 | 25건 | 50건 | Sheets "예약 내역" | 월간 |
| 월 매출 (수강료) | 40만원 | 100만원 | 225만원 | Sheets "정산 내역" | 월간 |
| 월 수수료 수익 | 4만원 | 10만원 | 25만원 | Sheets "정산 내역" | 월간 |
| 적립금->재료 구매 전환 | - | 30% | 50% | 적립금 사용 내역 | 월간 |
| 상세->결제 전환율 | 10% | 12% | 15% | GA4 퍼널 | 주간 |
| 수강 후 재료 구매 전환 | - | 25% | 40% | GA4 | 월간 |
| 후기 작성률 | 15% | 20% | 30% | Sheets "리뷰" | 월간 |
| 파트너 이탈률 | - | 0% | 10% 미만 | Sheets "파트너 상세" | 월간 |

#### Phase 2~3 목표 (4~6개월)

| KPI | 4개월 | 5개월 | 6개월 | 비고 |
|-----|-------|-------|-------|------|
| 등록 파트너 | 20명 | 25명 | 30명 | |
| 활성 파트너 | 12명 | 15명 | 20명 | |
| 월간 수강 예약 | 70건 | 100건 | 150건 | Phase 3 목표 |
| 월 매출 (수강료) | 350만원 | 500만원 | 750만원 | |
| 월 수수료 수익 | 40만원 | 60만원 | 100만원 | Phase 3 목표 |
| GOLD 등급 파트너 | 2명 | 3명 | 5명 | |
| 적립금->재료 구매 전환 | 55% | 55% | 60% | |
| 후기 작성률 | 30% | 35% | 40% | |
| 파트너 NPS | - | 7.5+ | 8.0+ | 분기별 설문 |

### 5.2 파트너 1인당 월 수익 시뮬레이션

#### 시나리오 A: 소규모 파트너 (자택 공방, 월 2회)

```
프로필: 취미 강사, 자택에서 소규모 운영
등급: SILVER
클래스: 하바리움 입문 (35,000원, 5명 정원)
월 운영: 2회

수강료 매출: 35,000 x 5 x 2 = 350,000원

[비용]
  재료비: 8,000원/인 x 5 x 2 = 80,000원
  적립금 활용: -35,000원
  실 재료비: 45,000원
  공간비: 0원 (자택)
  교통비: 0원
  기타: 10,000원

[수익]
  현금 수령: 315,000원
  적립금: 35,000원 (재료 구매 사용)
  지출 합계: 55,000원
  월 순이익: 260,000원

시간당 수익: 260,000 / (2회 x 1.5시간 + 준비 2시간) = 약 47,000원/시간
```

#### 시나리오 B: 중규모 파트너 (공방 운영, 월 4회)

```
프로필: 전업 강사, 공방 운영
등급: GOLD (12%, 80% 적립금)
클래스: 압화 에코백 + 레진 키링 (평균 50,000원, 8명 정원)
월 운영: 4회

수강료 매출: 50,000 x 8 x 4 = 1,600,000원

[비용]
  재료비: 12,000원/인 x 8 x 4 = 384,000원
  적립금 활용: -153,600원
  실 재료비: 230,400원
  공간비: 300,000원/월
  조교비: 0원
  기타: 50,000원

[수익]
  현금 수령: 1,408,000원
  적립금: 153,600원 (재료 구매 사용)
  지출 합계: 580,400원
  월 순이익: 827,600원

시간당 수익: 827,600 / (4회 x 2시간 + 준비 6시간) = 약 59,000원/시간
```

#### 시나리오 C: 대규모 파트너 (복수 클래스, 월 8회)

```
프로필: 전업 강사, 대형 공방 + 기업 출강
등급: PLATINUM (15%, 60% 적립금)
클래스: 3종 (압화 액자 60,000원, 보존화 꽃다발 70,000원, 기업 워크숍 50,000원)
월 운영: 8회 (오프라인 6회 + 기업 출강 2회)

수강료 매출: 오프라인 65,000 x 8 x 6 = 3,120,000원
            기업 50,000 x 15 x 2 = 1,500,000원
            합계 = 4,620,000원

[비용]
  재료비: 평균 15,000원 x 총 78명 = 1,170,000원
  적립금 활용: -415,800원
  실 재료비: 754,200원
  공간비: 500,000원
  조교비: 400,000원
  교통비(출강): 100,000원
  기타: 100,000원

[수익]
  현금 수령: 3,927,000원
  적립금: 415,800원 (재료 구매 사용)
  지출 합계: 1,854,200원
  월 순이익: 2,072,800원

시간당 수익: 2,072,800 / (8회 x 2.5시간 + 준비 12시간) = 약 64,000원/시간
```

### 5.3 플랫폼 손익분기점 분석

#### PRESSCO21 비용 구조 (Phase 2 운영)

| 비용 항목 | 월 비용 | 비고 |
|----------|--------|------|
| Google Workspace (전환 시) | 8,000원 | 이메일 한도 확장 |
| 도메인/호스팅 | 0원 | 메이크샵 포함 |
| GAS 운영 | 0원 | Google 무료 |
| 관리자 인건비 (파트타임) | 500,000원 | 파트너 관리, CS, 정산 확인 |
| 마케팅/홍보 | 200,000원 | 초기 파트너 모집 |
| 기타 (예비비) | 100,000원 | |
| **월 고정 비용 합계** | **808,000원** | |

#### 수익 구조

```
PRESSCO21 수익 = 직접 수수료 수익 + 적립금 환류 재료 매출 이익

직접 수수료 수익:
  = 총 수수료 - 적립금 전환액
  = 총 매출 x 평균수수료율 x (1 - 평균적립금전환율)

적립금 환류 재료 매출 이익:
  = 적립금 전환액 x 재료구매전환율 x 재료마진율
```

#### 손익분기점 시나리오

| 시나리오 | 월 매출 | 평균수수료 | 직접수익 | 적립금환류이익 | 총수익 | 손익 |
|---------|--------|---------|---------|-------------|--------|------|
| 최소 (1개월) | 40만원 | 10% | 0원 | 16,000원 | 16,000원 | -792,000원 |
| 성장 (3개월) | 225만원 | 10.5% | 5,250원 | 94,500원 | 99,750원 | -708,250원 |
| 안정 (6개월) | 750만원 | 11.5% | 51,750원 | 259,200원 | 310,950원 | -497,050원 |
| **손익분기** | **1,850만원** | **12.5%** | **231,250원** | **592,000원** | **823,250원** | **+15,250원** |
| 성장 (12개월) | 2,500만원 | 13% | 487,500원 | 720,000원 | 1,207,500원 | +399,500원 |

```
손익분기 조건:
  월 매출 약 1,850만원 (월 370건 x 평균 50,000원)
  파트너 약 40~50명 (활성 30명)
  등급 분포: SILVER 50%, GOLD 35%, PLATINUM 15%

현실적 손익분기 도달 시점: 서비스 오픈 후 10~14개월
```

**주의: 위 분석은 관리자 인건비 50만원을 포함한 보수적 추정이다.** 관리자가 기존 PRESSCO21 운영자(대표)라면 인건비를 제외할 수 있으며, 그 경우 손익분기는 월 매출 약 700만원 (Phase 2 목표인 6개월차)에서 달성 가능하다.

```
관리자 인건비 제외 시 손익분기:
  월 고정비: 308,000원
  필요 매출: 약 700만원 (월 140건 x 50,000원)
  도달 시점: 서비스 오픈 후 5~6개월 (Phase 2 말~Phase 3 초)
```

---

## 6. 파트너 온보딩 인센티브

### 6.1 초기 파트너 모집 전략

**목표: 첫 3개월 내 15명 등록, 10명 활성화**

#### 단계별 모집 계획

| 단계 | 기간 | 대상 | 목표 | 방법 |
|------|------|------|------|------|
| 1. 시드 파트너 | 1~2주 | 기존 거래처 3명 | 3명 등록 | 직접 연락, 무료 체험 |
| 2. 확장 모집 | 3~6주 | 파트너맵 등록 공방 | +5명 (총 8명) | 이메일, 전화 영업 |
| 3. 자연 유입 | 7~12주 | 인스타그램/블로그 강사 | +7명 (총 15명) | 성공 사례 마케팅 |

### 6.2 신규 파트너 지원 프로그램

#### A. 첫 3개월 수수료 면제 프로그램

| 항목 | 내용 |
|------|------|
| 대상 | 신규 등록 파트너 전원 |
| 기간 | 첫 가입 후 3개월간 |
| 혜택 | 수수료 0% (전액 파트너 수령) |
| 조건 | 월 최소 1회 이상 클래스 운영 |
| 목적 | 진입 장벽 제거, 플랫폼 체험 유도 |
| 종료 후 | 4개월째부터 SILVER 수수료 10% 적용 |

**비용 시뮬레이션:**

```
파트너 15명 x 월 평균 매출 15만원 x 3개월 = 675만원 매출
수수료 면제 비용 = 675만원 x 10% = 67.5만원 (적립금으로 지급했을 금액)
실제 손실 = 0원 (적립금 미지급이므로 현금 손실 없음)

대신 포기하는 것: 적립금을 통한 재료 구매 유도 효과
3개월 후 효과: 파트너가 플랫폼에 정착하면 지속적 수수료 + 적립금 환류 발생
```

#### B. 첫 클래스 보장 프로그램

| 항목 | 내용 |
|------|------|
| 대상 | 첫 클래스를 등록한 파트너 |
| 혜택 | 최소 수강인원 미달 시에도 클래스 진행 보장 |
| 조건 | 최소 2명 이상 신청 시 진행 (정원의 25% 이상) |
| 보전 | 정원 미달분 재료비를 PRESSCO21이 부담 (최대 5인분) |
| 한도 | 파트너당 1회, 재료비 최대 50,000원 |
| 목적 | "클래스를 올려도 사람이 안 오면 어쩌지" 불안감 해소 |

**비용 시뮬레이션:**

```
대상: 15명 파트너 x 1회 = 최대 15회
예상 발동 건수: 15회 중 5~8회 (30~50%)
건당 보전 비용: 평균 30,000원
총 비용: 약 150,000~240,000원

효과: 파트너 첫 클래스 등록률 80% 이상 (불안감 해소)
```

#### C. 재료 스타터 키트

| 항목 | 내용 |
|------|------|
| 대상 | 신규 파트너 중 PRESSCO21 거래 이력이 없는 경우 |
| 혜택 | 첫 클래스용 재료 샘플 키트 무료 제공 |
| 구성 | 클래스 유형별 기본 재료 세트 (5인분, 약 40,000원 상당) |
| 조건 | 필수 교육 이수 + 첫 클래스 등록 완료 |
| 목적 | 재료 품질 체험 + 향후 재료 구매 유도 |
| 한도 | 월 5명, 총 20명까지 |

**비용 시뮬레이션:**

```
대상: 20명 x 40,000원(원가 기준) = 800,000원
효과: 재료 샘플 체험 -> 정식 구매 전환율 70% 이상 예상
ROI: 20명 x 70% x 월 재료구매 50,000원 x 12개월 = 8,400,000원 연 매출
```

### 6.3 파트너 추천 프로그램

| 항목 | 내용 |
|------|------|
| 추천인 혜택 | 추천 파트너가 첫 클래스 완료 시 50,000원 적립금 |
| 피추천인 혜택 | 가입 축하 적립금 30,000원 |
| 조건 | 피추천인이 가입 후 3개월 내 클래스 3회 이상 운영 |
| 한도 | 추천인 1인당 연 5명까지 |
| 목적 | 기존 파트너의 네트워크를 통한 자연스러운 확장 |

### 6.4 온보딩 타임라인

```
[D-day: 파트너 신청]
  +0일: 신청서 접수 (Google Forms)
  +1~3일: 관리자 심사 (사업자등록증, 포트폴리오)
  +3일: 승인/반려 이메일

[승인 후]
  +3일: 파트너 코드 발급 + 필수 교육 안내
  +4~7일: 필수 교육 이수 (YouTube + 퀴즈)
  +7일: 교육 이수 완료 -> SILVER 등급 활성화
  +7~10일: 첫 클래스 등록 지원 (1:1 가이드)
  +10~14일: 클래스 상품 등록 + 검수
  +14일: 클래스 오픈

[첫 클래스 이후]
  +21~28일: 첫 클래스 진행
  +31일: 첫 정산 + 온보딩 만족도 설문
  +60일: 2개월차 점검 (활성화 여부 확인)
  +90일: 3개월 수수료 면제 종료 -> SILVER 수수료 적용
```

---

## 7. 구현 참조 (GAS/Sheets 매핑)

### 7.1 Sheets "정산 내역" 시트 컬럼 설계

| 컬럼 | 데이터 타입 | 설명 | 예시 |
|------|-----------|------|------|
| A: 정산ID | 문자열 | 자동 생성 (SETTLE-YYYYMMDD-NNN) | SETTLE-20260401-001 |
| B: 주문번호 | 문자열 | 메이크샵 주문번호 | 2026040112345 |
| C: 파트너코드 | 문자열 | 파트너 고유 코드 | PTN-001 |
| D: 파트너등급 | 문자열 | 정산 시점 등급 | SILVER |
| E: 클래스명 | 문자열 | 클래스 상품명 | 압화 에코백 원데이 |
| F: 수업일 | 날짜 | 클래스 진행일 | 2026-04-05 |
| G: 수강인원 | 정수 | 결제 인원 | 6 |
| H: 건별매출 | 정수 | 수강료 x 인원 | 270000 |
| I: 월누적매출 | 정수 | 해당 월 파트너 누적 | 520000 |
| J: 수수료율 | 실수 | 등급별 수수료율 | 0.10 |
| K: 수수료액 | 정수 | 건별매출 x 수수료율 | 27000 |
| L: 적립금전환율 | 실수 | 등급별 전환율 | 1.00 |
| M: 적립금지급액 | 정수 | 수수료액 x 적립금전환율 | 27000 |
| N: PRESSCO21수익 | 정수 | 수수료액 - 적립금지급액 | 0 |
| O: 정산상태 | 문자열 | 예약확정/대기/수강완료/처리중/완료/실패/취소 | 완료 |
| P: 적립금API결과 | 문자열 | API 응답 코드 | 0000 |
| Q: 정산일시 | 날짜시간 | 적립금 지급 시점 | 2026-04-08 09:00:00 |
| R: 비고 | 문자열 | 특이사항 | |

### 7.2 수수료 계산 GAS 함수 시그니처

```
// 의사 코드 - Task 221 구현 시 참조

FUNCTION calculateCommission(orderId, partnerId, classDate, amount):
    INPUT:
      orderId     - 메이크샵 주문번호 (문자열)
      partnerId   - 파트너 코드 (문자열, "PTN-001")
      classDate   - 수업 예정일 (Date)
      amount      - 결제 금액 (정수, 원 단위)

    PROCESS:
      1. partner = getPartnerDetail(partnerId)  // Sheets에서 조회
      2. grade = partner.grade                  // "SILVER" / "GOLD" / "PLATINUM"
      3. commissionRate = getCommissionRate(grade)
         // SILVER: 0.10, GOLD: 0.12, PLATINUM: 0.15
      4. reserveConversionRate = getReserveConversionRate(grade)
         // SILVER: 1.00, GOLD: 0.80, PLATINUM: 0.60
      5. commissionAmount = Math.round(amount * commissionRate)
      6. reserveAmount = Math.round(commissionAmount * reserveConversionRate)
      7. pressco21Revenue = commissionAmount - reserveAmount
      8. monthlyTotal = getMonthlyTotal(partnerId, currentMonth())

    OUTPUT:
      {
        orderId: orderId,
        partnerId: partnerId,
        grade: grade,
        amount: amount,
        commissionRate: commissionRate,
        commissionAmount: commissionAmount,
        reserveConversionRate: reserveConversionRate,
        reserveAmount: reserveAmount,
        pressco21Revenue: pressco21Revenue,
        monthlyTotal: monthlyTotal + amount,
        settlementStatus: "대기",
        scheduledSettlementDate: addDays(classDate, 3)
      }

FUNCTION processSettlement(settlementId):
    INPUT:
      settlementId - 정산 ID (문자열, "SETTLE-YYYYMMDD-NNN")

    PROCESS:
      1. settlement = getSettlement(settlementId)  // Sheets에서 조회
      2. IF settlement.status != "수강완료": RETURN error
      3. updateStatus(settlementId, "처리중")
      4. result = callMakeshopReserveAPI(
           settlement.partnerId,
           settlement.reserveAmount,
           "[클래스 정산] " + settlement.className + " (" + settlement.classDate + ")"
         )
      5. IF result.return_code == "0000" AND result.datas[0].result == true:
           updateStatus(settlementId, "완료")
           updateAPIResult(settlementId, "0000")
           sendSettlementEmail(settlement)
         ELSE:
           updateStatus(settlementId, "실패")
           updateAPIResult(settlementId, result.return_code)
           sendAdminAlert("정산 실패: " + settlementId)

    OUTPUT:
      { success: boolean, message: string }
```

### 7.3 등급 변경 검증 GAS 함수 시그니처

```
// 의사 코드 - Task 223 구현 시 참조

FUNCTION checkAndUpdateGrade(partnerId):
    INPUT:
      partnerId - 파트너 코드

    PROCESS:
      1. partner = getPartnerDetail(partnerId)
      2. stats = getPartnerStats(partnerId)
         // completedClasses, avgRating, reviewCount, monthlyAvgRevenue, refundRate

      3. IF partner.grade == "SILVER":
           IF stats.completedClasses >= 10
              AND stats.avgRating >= 4.0
              AND stats.reviewCount >= 5
              AND stats.refundRate < 0.15:
             scheduleGradeChange(partnerId, "GOLD", nextMonthFirstDay())
             RETURN { upgrade: true, newGrade: "GOLD" }

      4. IF partner.grade == "GOLD":
           // 승급 체크
           IF stats.completedClasses >= 50
              AND stats.avgRating >= 4.5
              AND stats.reviewCount >= 20
              AND stats.monthlyAvgRevenue >= 2000000
              AND stats.refundRate < 0.10
              AND partner.advancedTraining == true:
             scheduleGradeChange(partnerId, "PLATINUM", nextMonthFirstDay())
             RETURN { upgrade: true, newGrade: "PLATINUM" }

           // 강등 체크
           IF stats.recentAvgRating(3) < 3.5
              OR stats.recentRefundRate(6) >= 0.20
              OR stats.recentCompletedClasses(6) == 0:
             triggerDegradeWarning(partnerId, "SILVER")
             RETURN { warning: true, reason: "..." }

      5. IF partner.grade == "PLATINUM":
           // 강등 체크
           IF stats.recentAvgRating(3) < 4.0
              OR stats.recentRefundRate(6) >= 0.15
              OR stats.recentMonthlyAvgRevenue(3) < 1000000:
             triggerDegradeWarning(partnerId, "GOLD")
             RETURN { warning: true, reason: "..." }

      RETURN { noChange: true }
```

### 7.4 적립금 API 호출 래퍼

```
// 의사 코드 - Task 201 구현 시 참조
// 실제 API 스펙: docs/api-verification/reserve-api-result.md 참조

FUNCTION grantPartnerReserve(memberId, amount, reason):
    INPUT:
      memberId - 메이크샵 회원 ID (문자열, 예: "jihoo5755")
      amount   - 적립금 (정수, 양수=지급, 음수=차감)
      reason   - 사유 (문자열, 예: "[클래스 정산] 압화 에코백 (2026-04-05)")

    PROCESS:
      1. url = MAKESHOP_DOMAIN + "/list/open_api_process.html"
             + "?mode=save&type=reserve&process=give"
      2. payload = {
           datas: [{
             id: memberId,
             reserve: String(amount),
             content: reason,
             date: formatDate(now(), "yyyy-MM-dd HH:mm:ss")
           }]
         }
      3. response = UrlFetchApp.fetch(url, {
           method: "POST",
           headers: { Shopkey: SHOP_KEY, Licensekey: LICENSE_KEY },
           payload: JSON.stringify(payload)
         })
      4. result = JSON.parse(response.getContentText())
      5. IF result.return_code == "0000" AND result.datas[0].result == true:
           logSuccess(memberId, amount, reason)
           RETURN { success: true }
         ELSE:
           logFailure(memberId, amount, reason, result)
           RETURN { success: false, error: result.datas[0].message }

    ERROR HANDLING:
      - UrlFetchApp 타임아웃: 30초 후 재시도 1회, 실패 시 "실패" 기록
      - return_code != "0000": IP 제한, 권한 오류 등 -> 관리자 알림
      - result == false: 회원 미존재, 금액 오류 등 -> 해당 건만 실패 처리
      - 이중 지급 방지: 자동 재시도 없음, 관리자 수동 확인 후 재처리
```

---

## 변경 이력

| 날짜 | 버전 | 내용 |
|------|------|------|
| 2026-02-21 | 1.0 | 초기 정책 설계서 작성 (ecommerce-business-expert) |
