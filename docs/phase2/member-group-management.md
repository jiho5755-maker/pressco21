# 메이크샵 회원그룹 관리 가이드

> **작성일**: 2026-02-21
> **대상**: PRESSCO21 관리자
> **목적**: 파트너(강사회원) 및 수강생 회원그룹의 설정, 승인 절차, GAS 연동 관리
> **관련 Task**: Task 202, Task 222, Task 223

---

## 목차

1. [회원그룹 구조 개요](#1-회원그룹-구조-개요)
2. [강사회원 그룹 설정 및 관리](#2-강사회원-그룹-설정-및-관리)
3. [파트너 승인 절차](#3-파트너-승인-절차)
4. [GAS 파트너 인증 연동](#4-gas-파트너-인증-연동)
5. [파트너 계정 비활성화](#5-파트너-계정-비활성화)
6. [파트너 등급 체계](#6-파트너-등급-체계)
7. [운영 시나리오별 대응](#7-운영-시나리오별-대응)

---

## 1. 회원그룹 구조 개요

PRESSCO21의 회원그룹은 메이크샵 D4의 기본 회원그룹 시스템을 활용합니다.

### 현재 그룹 구조

| 그룹명 | group_level | 용도 | 가상태그 확인 |
|--------|-------------|------|-------------|
| 일반회원 | 1 | 기본 회원 (수강생 포함) | Task 151 기본값 |
| 강사회원 | 2 | 파트너 (제휴 강사/공방) | Task 151 검증 완료 |

### 가상태그 동작 확인 결과 (Task 151)

- `<!--/group_name/-->`: 로그인한 회원의 그룹명 출력 (예: "강사회원")
- `<!--/group_level/-->`: 로그인한 회원의 그룹 레벨 출력 (예: "2")
- 개별 페이지(page.html)에서도 정상 동작 확인됨

### 왜 회원그룹을 사용하는가?

| 목적 | 설명 |
|------|------|
| 파트너 식별 | GAS에서 member_id로 파트너 여부를 확인하지만, 메이크샵 네이티브 기능(할인 등)은 그룹으로 구분 |
| 할인/적립 차등 | 강사회원에게 재료 도매가(할인) 적용 가능 |
| 접근 제어 | 파트너 전용 페이지에서 `<!--/if_group_level/-->` 등으로 접근 제한 (테스트 필요) |
| 관리 편의 | 관리자가 회원 목록에서 파트너만 필터링하여 조회 가능 |

---

## 2. 강사회원 그룹 설정 및 관리

### 2-1. 회원그룹 관리 페이지

```
메이크샵 관리자 > 회원관리 > 회원등급관리
```

### 2-2. 기존 "강사회원" 그룹 확인

이미 "강사회원" 그룹이 생성되어 있습니다 (group_level=2, Task 151에서 확인).

확인할 사항:
1. 그룹명이 "강사회원"으로 되어 있는지
2. group_level이 2인지
3. 해당 그룹에 할인/적립 설정이 있는지

### 2-3. 강사회원 그룹 혜택 설정 (권장)

```
메이크샵 관리자 > 회원관리 > 회원등급관리 > "강사회원" 수정
```

| 설정 항목 | 권장 값 | 이유 |
|----------|--------|------|
| 상품 할인율 | 10~20% | 파트너가 재료를 도매가에 구매할 수 있도록 |
| 적립금 적립률 | 3~5% | 일반 회원(1~2%)보다 높은 적립 |
| 그룹 아이콘 | 파트너 전용 배지 이미지 | 마이페이지에서 파트너 신분 표시 |

> **주의**: 적립금 적립률은 메이크샵의 "구매 시 적립" 기능을 말합니다. GAS의 수수료 기반 적립금 지급(`process_reserve`)과는 별개입니다.

### 2-4. 회원그룹 변경 방법

특정 회원을 강사회원으로 변경하는 방법:

```
메이크샵 관리자 > 회원관리 > 회원 리스트
```

1. 해당 회원 검색 (ID 또는 이름)
2. 회원 정보 수정 페이지 진입
3. "회원그룹" 항목에서 "강사회원" 선택
4. **저장**

**또는 API를 통한 자동 변경:**
```
process_member API 호출
- member_id: 대상 회원 ID
- group_no: 강사회원 그룹 번호
```

> **참고**: `process_member` API를 통한 자동 그룹 변경은 Phase 2-C (Task 223)에서 구현 예정입니다. 현재는 관리자가 수동으로 변경합니다.

---

## 3. 파트너 승인 절차

### 3-1. 전체 플로우

```
파트너 신청 -> 관리자 검토 -> 승인/거절 -> 시스템 반영
```

### 3-2. 단계별 상세

#### STEP 1: 파트너 신청

현재(Phase 2-A): 이메일 또는 전화로 신청 접수
향후(Phase 2-C, Task 223): Google Forms를 통한 온라인 신청

**파트너 신청 시 수집 정보:**

| 항목 | 필수 여부 | 용도 |
|------|----------|------|
| 메이크샵 회원 ID | 필수 | GAS 파트너 인증의 핵심 키 |
| 성함/공방명 | 필수 | 클래스 상품명에 표시 |
| 연락처 (이메일/전화) | 필수 | 예약 안내 이메일 발송 |
| 활동 지역 | 필수 | 파트너맵 연동, 지역 필터 |
| 전문 분야 | 필수 | 카테고리 분류 |
| 포트폴리오/인스타그램 | 권장 | 품질 검증, 프로필 표시 |
| 사업자등록증 | 권장 | 정산 신뢰성 |

#### STEP 2: 관리자 검토

관리자가 확인할 사항:

1. **메이크샵 회원 여부**: 해당 ID로 회원 가입이 되어 있는지
   ```
   메이크샵 관리자 > 회원관리 > 회원 리스트 > 회원 ID 검색
   ```
2. **포트폴리오 검토**: 수업 품질이 PRESSCO21 브랜드에 적합한지
3. **활동 지역 확인**: 기존 파트너와 과도하게 겹치지 않는지
4. **전문 분야 확인**: 압화/보존화/레진공예/하바리움 관련 분야인지

#### STEP 3: 승인 처리

승인이 결정되면 다음 3가지를 순서대로 수행합니다.

**3-A. 메이크샵 회원그룹 변경**

```
메이크샵 관리자 > 회원관리 > 회원 리스트 > 해당 회원 > 회원그룹: "강사회원" 선택 > 저장
```

**3-B. Google Sheets "파트너 상세" 시트에 등록**

| 컬럼 | 필드명 | 입력 내용 |
|------|--------|----------|
| A | partner_code | 새 파트너 코드 부여 (P001, P002, ...) |
| B | member_id | **메이크샵 회원 ID** (가장 중요!) |
| C | partner_name | 공방/강사명 |
| D | grade | SILVER (신규 파트너 기본값) |
| E | email | 파트너 이메일 |
| F | phone | 파트너 연락처 |
| G | location | 활동 지역 |
| H | commission_rate | 0.10 (SILVER 기본값) |
| I | reserve_rate | 1.00 (SILVER 기본값) |
| J | class_count | 0 |
| K | avg_rating | 0 |
| L | education_completed | FALSE |
| P | approved_date | 오늘 날짜 |
| Q | status | ACTIVE |

**3-C. 파트너에게 승인 안내**

이메일 또는 전화로 다음 내용을 안내합니다:

- 파트너 승인 완료 안내
- 파트너 코드 (P00X) 안내
- 클래스 등록 절차 안내 (class-product-registration.md 참조)
- 파트너 대시보드 접근 방법 안내 (Phase 2-C 이후)
- 수수료/적립금 정책 안내 (commission-policy.md 참조)

#### STEP 4: 거절 처리

거절 시에는 이메일로 사유를 안내하고, 재신청 가능 여부를 알려줍니다.

---

## 4. GAS 파트너 인증 연동

### 4-1. 인증 아키텍처 (Task 151 확정)

파트너 클래스 플랫폼의 인증은 다음 3단계로 동작합니다.

```
[1단계: 메이크샵 서버]
HTML에 삽입된 가상태그가 서버에서 치환됩니다.

  <span id="ptn-user-id" style="display:none"><!--/user_id/--></span>
                                    |
                                    v
  로그인 상태: <span id="ptn-user-id" style="display:none">jihoo5755</span>
  비로그인:    <span id="ptn-user-id" style="display:none"></span>


[2단계: JavaScript]
JS가 DOM에서 회원 ID를 읽고 GAS에 전달합니다.

  var memberId = document.getElementById('ptn-user-id').textContent.trim();
  if (!memberId) {
    // 비로그인 -> 로그인 페이지로 이동
    window.location.href = '/shop/member.html?type=login';
    return;
  }
  // GAS 호출
  fetch(GAS_URL + '?action=getPartnerAuth&member_id=' + encodeURIComponent(memberId))


[3단계: GAS 서버]
GAS가 member_id로 파트너 여부를 확인합니다.

  1) Referer 체크 (foreverlove.co.kr만 허용)
  2) member_id -> "파트너 상세" 시트 B열에서 검색
  3) 결과:
     - 미등록:        { success: false, error: "NOT_PARTNER" }
     - 비활성 파트너:  { success: false, error: "PARTNER_INACTIVE" }
     - 정상 파트너:    { success: true, partner: { code, grade, name, ... } }
```

### 4-2. 핵심 매칭 로직

파트너 인증의 핵심은 **member_id와 Sheets "파트너 상세" 시트 B열의 매칭**입니다.

```
사용자 로그인 ID (메이크샵)  ==  "파트너 상세" 시트 B열 member_id
         jihoo5755           ==        jihoo5755
```

따라서 **"파트너 상세" 시트 B열에 정확한 메이크샵 회원 ID가 기입되어 있어야** 합니다.

### 4-3. member_id 기입 시 주의사항

- **대소문자 정확히 일치**: 메이크샵 회원 ID는 대소문자를 구분합니다
- **공백 없음**: 앞뒤 공백이 들어가면 매칭 실패
- **메이크샵 관리자에서 확인**: 관리자 > 회원관리 > 회원 리스트에서 정확한 ID 확인
- **파트너 본인에게도 확인**: "메이크샵 로그인 ID가 무엇인가요?"

### 4-4. 인증 실패 시 디버깅

파트너가 "파트너로 인식되지 않는다"고 신고할 경우:

1. **Sheets "파트너 상세" 확인**: B열에 해당 member_id가 있는지
2. **대소문자 확인**: 정확히 일치하는지
3. **상태 확인**: Q열(status)이 ACTIVE인지
4. **메이크샵 회원 확인**: 관리자에서 해당 ID 검색 -> 실제 존재하는 회원인지
5. **로그인 상태 확인**: 파트너가 실제로 로그인한 상태인지

---

## 5. 파트너 계정 비활성화

### 5-1. 일시 정지

파트너가 일시적으로 활동을 중단하는 경우:

**Google Sheets 처리:**
1. "파트너 상세" Q열(status): `ACTIVE` -> `SUSPENDED`
2. 해당 파트너의 모든 클래스 ("클래스 메타" T열): `ACTIVE` -> `INACTIVE`

**메이크샵 처리:**
1. 해당 파트너의 클래스 상품: 판매 상태를 "품절" 또는 "비노출"로 변경
2. 회원그룹은 "강사회원" 유지 (도매가 혜택 유지)

**결과:**
- 파트너 대시보드 접근 시 "PARTNER_INACTIVE" 에러 표시
- 클래스 목록에서 해당 파트너의 클래스 비표시
- 기존 예약된 수업은 정상 진행 (정산도 정상 처리)

### 5-2. 완전 비활성화

파트너 계약을 완전히 해지하는 경우:

**Google Sheets 처리:**
1. "파트너 상세" Q열(status): `ACTIVE` -> `INACTIVE`
2. 해당 파트너의 모든 클래스 ("클래스 메타" T열): -> `INACTIVE`
3. **행을 삭제하지 마세요** - 과거 정산 내역 참조를 위해 보존

**메이크샵 처리:**
1. 해당 파트너의 클래스 상품: 전부 비노출 처리
2. 회원그룹: "강사회원" -> "일반회원"으로 변경 (도매가 혜택 회수)

**잔여 적립금 처리:**
- 파트너에게 남은 적립금 사용 기한 안내 (예: 30일)
- 기한 후 잔여 적립금 처리 방침은 관리자 재량

### 5-3. 재활성화

비활성화된 파트너를 다시 활성화하는 경우:

1. "파트너 상세" Q열(status): -> `ACTIVE`
2. 클래스 상태 재검토 후 필요한 클래스만 `ACTIVE`로 변경
3. 메이크샵 회원그룹: "강사회원"으로 변경 (비활성화 시 변경했다면)
4. 메이크샵 상품 판매 상태: "판매중"으로 변경

---

## 6. 파트너 등급 체계

### 6-1. 등급 구조

| 등급 | 조건 | 수수료율 | 적립금 전환율 | 혜택 |
|------|------|---------|-------------|------|
| SILVER | 기본 (신규 파트너) | 10% | 100% | 기본 할인 |
| GOLD | 수강 완료 10건+, 평균 별점 4.0+ | 12% | 80% | 우선 노출, 배지 |
| PLATINUM | 수강 완료 50건+, 평균 별점 4.5+ | 15% | 60% | 전용 배너, VIP 지원 |

### 6-2. 수수료율과 적립금 전환율의 관계

```
매출 x 수수료율 = 수수료 금액
수수료 금액 x 적립금 전환율 = 실제 지급 적립금

예시 (SILVER, 65,000원 수강료):
  65,000 x 10% = 6,500원 (수수료)
  6,500 x 100% = 6,500원 (적립금)

예시 (GOLD, 65,000원 수강료):
  65,000 x 12% = 7,800원 (수수료)
  7,800 x 80%  = 6,240원 (적립금)

예시 (PLATINUM, 65,000원 수강료):
  65,000 x 15% = 9,750원 (수수료)
  9,750 x 60%  = 5,850원 (적립금)
```

> 등급이 높을수록 수수료율은 올라가지만, 적립금 전환율은 내려갑니다. 이는 파트너가 적립금(재료 구매)뿐 아니라 높은 수수료를 통한 실질 수익 증가를 체감하게 하는 구조입니다.

### 6-3. 등급 변경 절차

현재(Phase 2-A): 관리자가 수동으로 등급 변경
향후(Phase 2-C, Task 223): GAS 배치 함수로 자동 등급 산정

**수동 등급 변경 방법:**

1. Google Sheets "파트너 상세" 시트에서 해당 파트너 찾기
2. J열(class_count)과 K열(avg_rating) 확인
3. 등급 조건 충족 시:
   - D열(grade): SILVER -> GOLD 또는 GOLD -> PLATINUM
   - H열(commission_rate): 해당 등급의 수수료율로 변경
   - I열(reserve_rate): 해당 등급의 적립금 전환율로 변경

---

## 7. 운영 시나리오별 대응

### 시나리오 1: 신규 파트너 온보딩

```
1. 파트너 신청 접수
2. 관리자 검토 (포트폴리오, 전문 분야)
3. 승인 결정
4. 메이크샵 회원그룹 변경 (일반 -> 강사회원)
5. Sheets "파트너 상세"에 등록 (B열 member_id 정확히!)
6. 파트너에게 승인 안내 + 가이드 전달
7. 첫 클래스 상품 등록 지원 (class-product-registration.md 참고)
```

### 시나리오 2: 파트너가 회원 ID를 변경한 경우

메이크샵에서 회원 ID는 변경이 불가합니다. 파트너가 새 계정을 만든 경우:

```
1. 새 회원 ID 확인
2. Sheets "파트너 상세" B열(member_id) 업데이트
3. 새 계정을 "강사회원" 그룹으로 변경
4. 기존 계정은 "일반회원"으로 변경
5. 기존 적립금 이관 여부 결정 (관리자 재량)
```

### 시나리오 3: 파트너가 비밀번호를 분실한 경우

메이크샵 기본 비밀번호 찾기 기능을 안내합니다. GAS/Sheets 시스템에는 비밀번호가 저장되지 않으므로 별도 조치 불필요.

```
foreverlove.co.kr > 로그인 > "비밀번호 찾기"
```

### 시나리오 4: 파트너 등급 승급 요청

```
1. Sheets "파트너 상세"에서 해당 파트너의 J열(class_count), K열(avg_rating) 확인
2. 등급 조건 충족 여부 판단
3. 충족 시: 등급, 수수료율, 적립금 전환율 변경
4. 미충족 시: 현재 실적 안내 + 목표 수치 안내
```

### 시나리오 5: 수강생이 파트너로 전환하려는 경우

기존 회원이 파트너 자격으로 전환하고 싶은 경우:

```
1. 파트너 신청 절차 동일하게 진행
2. 기존 회원 ID를 그대로 사용 (새 가입 불필요)
3. 회원그룹만 "강사회원"으로 변경
4. 기존 구매 이력/적립금은 유지됨
```

---

## 부록: 관련 문서

| 문서 | 경로 | 내용 |
|------|------|------|
| 클래스 상품 등록 가이드 | `docs/phase2/class-product-registration.md` | 상품 등록 단계별 가이드 |
| 수수료 정책 | `docs/phase2/commission-policy.md` | 등급별 수수료/적립금 정책 상세 |
| GAS 배포 가이드 | `docs/phase2/gas-deployment-guide.md` | GAS 웹 앱 배포 방법 |
| 메이크샵 API 아키텍처 | `docs/phase2/makeshop-api-architecture.md` | API 연동 구조 |
| 적립금 API 검증 결과 | `docs/api-verification/reserve-api-result.md` | process_reserve API 테스트 결과 |
| 가상태그 검증 결과 | `docs/api-verification/substitution-options-result.md` | 치환코드 테스트 결과 |
