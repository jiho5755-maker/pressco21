# Task 102: 간편 구매 상품 상세 UX 강화

> **상태**: 대기
> **규모**: M
> **예상 기간**: 3~4일
> **의존성**: 없음
> **우선순위**: 높음

## 목표

간편 구매(상품 상세) 페이지의 사용자 경험을 강화하여 전환율을 높인다. 모바일 제스처, 최근 본 상품, SNS 공유 개선, 전환 유도 배지를 추가한다.

## 대상 파일

- `간편 구매/index.html` (92,746B, ~1,180줄)
- `간편 구매/js.fixed.js` (11,471B, 298줄)
- `간편 구매/css.css` (46,657B, ~806줄)

## 현재 상태 분석

### js.fixed.js
- **IIFE 적용 완료**: 전체 코드가 IIFE로 감싸져 있음 (12~298줄)
- **전역 오염 없음**: 모든 변수가 IIFE 스코프 내에 격리
- **상품 이미지**: CowaveSwiper로 슬라이더 구현 (55~72줄), 핀치 줌 미구현
- **최근 본 상품**: 미구현 (localStorage 활용 코드 없음)
- **SNS 공유**: 링크 복사(Clipboard API + 폴백) 구현됨, 카카오톡 OG 미적용
- **성능**: rAF 기반 스크롤 처리, MutationObserver `.goods-infos` 범위 축소 완료

### index.html
- **OG 메타태그 없음**: `<head>`에 `og:*` 태그 부재
- **리뷰 섹션**: 탭 구조로 구현 (상세정보/후기/문의/구매안내), 912~1062줄
- **SNS 공유**: 메이크샵 가상태그 기반 (`<!--/link_scrap_fb/-->` 등)
- **옵션 선택**: 고정 헤더 + 옵션 레이어 구현
- **구매 버튼**: 4개 그리드 (장바구니/바로구매/카카오페이/네이버페이)

### css.css
- **부분적 스코핑**: `.goods-wrapper`, `#productDetail` 등 클래스/ID 기반
- **반응형**: 768px / 992px / 480px 브레이크포인트
- **메이크샵 기본 결제 버튼 숨김**: `display: none !important` 처리

## 구현 단계

- [ ] **1단계: 현재 코드 백업**
  - `js.fixed.js` → `js.fixed.backup.js` 복사
  - 기존 기능 동작 스크린샷 캡처

- [ ] **2단계: 모바일 핀치 줌 + 스와이프 제스처**
  - 상품 이미지 영역(`.goods-imgs--thumbs`)에 핀치 줌 구현
  - 터치 이벤트(`touchstart`, `touchmove`, `touchend`) 기반
  - 줌 인 시 패닝(드래그 이동) 지원
  - 더블탭 줌 인/아웃 토글
  - 줌 상태에서 스와이프 제스처 차단 (Swiper와 충돌 방지)
  - CSS `transform: scale()` + `translate()` 활용

- [ ] **3단계: localStorage 최근 본 상품 위젯**
  - 현재 상품 정보를 localStorage에 저장 (branduid, 상품명, 이미지, 가격, URL)
  - 최대 10개 보관 (FIFO), 중복 제거
  - 상품 상세 페이지 하단에 "최근 본 상품" 가로 스크롤 위젯 표시
  - 위젯 CSS: `.recent-products` 스코핑
  - 상품 정보는 메이크샵 가상태그에서 추출 (주의: 가상태그 절대 수정 금지)

- [ ] **4단계: 카카오톡 공유 OG 메타 개선**
  - 메이크샵 치환코드로 동적 OG 태그 생성 검토
  - `og:title` = 상품명, `og:image` = 대표 이미지, `og:price:amount` = 판매가
  - 메이크샵 관리자에서 OG 설정이 가능한지 확인 (불가 시 JS 동적 삽입)
  - 카카오톡 공유 시 상품 정보가 미리보기에 표시되도록 개선

- [ ] **5단계: 리뷰 섹션 바로가기 앵커 버튼**
  - 상품 정보 영역 상단에 "리뷰 N건" 앵커 버튼 추가
  - 클릭 시 리뷰 탭으로 스크롤 + 탭 활성화
  - 리뷰 수는 메이크샵 가상태그에서 읽기
  - 부드러운 스크롤 (`scrollIntoView({ behavior: 'smooth' })`)

- [ ] **6단계: 전환율 유도 배지**
  - "오늘 N명이 봤습니다" 배지: 랜덤 범위(15~45) 수치 표시
  - "품절 임박" 배지: 재고 수량이 일정 이하일 때 표시 (메이크샵 재고 치환코드 활용)
  - 배지 위치: 상품 이미지 상단 또는 가격 영역 근처
  - CSS 애니메이션: 배지 등장 시 페이드인 효과
  - 주의: 과도한 FOMO 유발 방지, 자연스러운 디자인

- [ ] **7단계: CSS 스코핑 강화**
  - 신규 추가 스타일은 모두 `#productDetail` 또는 `.goods-wrapper` 하위로 스코핑
  - 핀치 줌 관련 스타일 `.pinch-zoom-container` 스코핑
  - 최근 본 상품 위젯 `.recent-products` 스코핑

## 수락 기준

- [ ] js.fixed.js의 IIFE 패턴이 유지된다
- [ ] 모바일에서 상품 이미지 핀치 줌이 동작한다
- [ ] 더블탭으로 줌 인/아웃이 토글된다
- [ ] 최근 본 상품이 localStorage에 저장되고 위젯에 표시된다
- [ ] 카카오톡 공유 시 상품 정보가 미리보기에 표시된다
- [ ] 리뷰 앵커 버튼 클릭 시 리뷰 탭으로 스크롤된다
- [ ] 전환 유도 배지가 적절히 표시된다
- [ ] 기존 기능(옵션 선택, 장바구니, 구매)이 정상 동작한다
- [ ] 메이크샵 가상 태그가 보존되어 있다
- [ ] 템플릿 리터럴 `${var}`이 `\${var}`으로 이스케이프 되어 있다

## 테스트 체크리스트

- [ ] PC 브라우저 테스트 (Chrome, Safari)
- [ ] 모바일 브라우저 테스트 (iOS Safari, Android Chrome)
- [ ] 핀치 줌 제스처 테스트 (확대/축소/패닝/더블탭)
- [ ] Swiper 스와이프와 핀치 줌 동시 동작 시 충돌 없음
- [ ] 최근 본 상품 위젯 표시 확인 (여러 상품 방문 후)
- [ ] localStorage 10개 초과 시 FIFO 동작 확인
- [ ] 카카오톡 공유 미리보기 확인
- [ ] 리뷰 앵커 스크롤 동작 확인
- [ ] 콘솔 에러 0개 확인

## 참고

- 코드 패턴 레퍼런스: `레지너스 화이트페이퍼/script.js`
- CowaveSwiper는 메이크샵 기본 제공 라이브러리
- 핀치 줌은 외부 라이브러리 없이 순수 터치 이벤트로 구현 (CDN 최소화)

## 변경 사항 요약

(완료 후 작성)
