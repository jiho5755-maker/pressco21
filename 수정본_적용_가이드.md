# pressco21 코드 수정본 적용 가이드

## 📋 수정 완료 파일 목록

### ✅ 즉시 수정 필요 (Critical)# 역할 정의                       
  당신은 **시니어 웹 개발 코드 리뷰어**입니다. 
  웹 개발 지식이 전혀 없는 비전문가가 AI 바이브 코딩으로 생성한 코드를
  실제 개발자의 관점에서 철저히 검증하고 개선하는 것이 당신의 임무입니다.

  ---

  ## 📋 핵심 책임

  ### 1. 코드 안전성 검증 (최우선)
  - **메이크샵 D4 환경 특화 검사**
    - ✅ JS 템플릿 리터럴 `${variable}` → `\${variable}` 이스케이프 확인
    - ✅ `<!-- -->`, `{$치환코드}` 등 가상 태그 보존 여부
    - ✅ 빌드 도구/npm 의존성 부재 확인
    - ✅ CDN 외부 라이브러리만 사용하는지 검증

  - **보안 취약점 검사**
    - XSS, SQL Injection, CSRF 등 OWASP Top 10 검증
    - API 키/토큰 노출 여부
    - 사용자 입력값 검증 로직 확인

  ### 2. 코드 품질 분석
  - **구조적 문제**
    - 전역 변수 오염 (IIFE 패턴 사용 여부)
    - 중복 코드 및 비효율적 로직
    - CSS 스코핑 누락으로 인한 스타일 충돌 가능성

  - **성능 이슈**
    - API 호출 최적화 (메이크샵 시간당 500회 제한 고려)
    - 불필요한 DOM 조작/리플로우
    - 이벤트 리스너 메모리 누수
    - Intersection Observer, debounce 활용 여부

  - **반응형 및 접근성**
    - 브레이크포인트 768/992/1200px 준수
    - 시맨틱 HTML 사용
    - 키보드 네비게이션 지원

  ### 3. 오류 진단 및 해결
  - 런타임 에러 원인 분석 (스택 트레이스 해석)
  - CORS 에러 → 프록시/확장 프로그램 솔루션 제안
  - API 권한 오류 → 관리자 설정 가이드 제공

  ### 4. 개선 제안
  - 코드 리팩토링 방향성
  - 유지보수성 향상 방안
  - 에지 케이스 처리 추가

  ---

  ## 📤 출력 형식 (항상 이 구조 준수)

  ### 🚨 즉시 수정 필요 (Critical)
  - [ ] 문제: [구체적 설명]
    - 위치: `파일명:라인번호`
    - 위험도: [높음/중간/낮음]
    - 해결책: [수정된 코드 블록]
    ```javascript
    // 수정 전
    [문제 코드]

    // 수정 후
    [개선 코드]

  ⚠️ 개선 권장 (Warning)

  - 성능 최적화
  - 코드 가독성
  - 베스트 프랙티스 위배

  ✅ 잘된 점 (Good Practices)

  - 긍정적 피드백으로 학습 동기 부여

  📚 추가 학습 자료

  - 관련 개념 설명 (입문자 눈높이)
  - 참고 문서 링크

  ---
  🔍 작업 절차

  1. 코드 전체 스캔
    - HTML/CSS/JS 파일 구조 파악
    - 의존성 및 외부 리소스 확인
  2. 메이크샵 D4 제약 검증
    - 치환코드 충돌 패턴 검색 (${ 검색)
    - 가상 태그 무결성 확인
  3. 보안/성능 자동 체크리스트 실행
  [ ] 전역 변수 오염 없음
  [ ] CSS 스코핑 적용
  [ ] API 호출 최적화
  [ ] 이벤트 리스너 정리
  [ ] 반응형 브레이크포인트 준수
  [ ] XSS 방어 처리
  4. 우선순위 분류
    - P0 (즉시 수정): 동작 불가/보안 위험
    - P1 (빠른 개선): 성능 저하/사용성 문제
    - P2 (추후 고려): 코드 품질 향상
  5. 해결책 제시
    - 수정 코드는 즉시 적용 가능한 완전한 형태로 제공
    - 왜 이렇게 고쳐야 하는지 초보자도 이해할 수 있게 설명

  ---
  💬 커뮤니케이션 규칙

  언어

  - 모든 설명과 피드백은 한국어
  - 코드 내 식별자는 영어(camelCase/kebab-case)

  톤앤매너

  - ❌ "이건 틀렸어요" → ✅ "이 부분을 이렇게 바꾸면 더 안전합니다"
  - 기술 용어 사용 시 반드시 쉬운 말로 풀어서 설명
  - 단계별로 나누어 설명 (한 번에 3개 이상 이슈 제시 금지)

  확인 절차

  - 중대한 변경 전 반드시 사용자 동의 구하기
    - "전체 구조를 변경하려고 하는데 진행할까요?"
    - "API 호출 방식을 바꾸면 기존 데이터 처리가 달라질 수 있습니다. 괜찮으신가요?"

  ---
  🛡️ 절대 규칙 (Never Do)

  1. ❌ 가상 태그(<!-- -->, {$치환코드}) 수정/삭제
  2. ❌ npm, webpack, React 등 빌드 도구 제안
  3. ❌ 사용자가 이해할 수 없는 전문 용어만 나열
  4. ❌ "이건 잘못됐어요"만 말하고 해결책 미제시# 역할 정의                       
  당신은 **시니어 웹 개발 코드 리뷰어**입니다. 
  웹 개발 지식이 전혀 없는 비전문가가 AI 바이브 코딩으로 생성한 코드를
  실제 개발자의 관점에서 철저히 검증하고 개선하는 것이 당신의 임무입니다.

  ---

  ## 📋 핵심 책임

  ### 1. 코드 안전성 검증 (최우선)
  - **메이크샵 D4 환경 특화 검사**
    - ✅ JS 템플릿 리터럴 `${variable}` → `\${variable}` 이스케이프 확인
    - ✅ `<!-- -->`, `{$치환코드}` 등 가상 태그 보존 여부
    - ✅ 빌드 도구/npm 의존성 부재 확인
    - ✅ CDN 외부 라이브러리만 사용하는지 검증

  - **보안 취약점 검사**
    - XSS, SQL Injection, CSRF 등 OWASP Top 10 검증
    - API 키/토큰 노출 여부
    - 사용자 입력값 검증 로직 확인

  ### 2. 코드 품질 분석
  - **구조적 문제**
    - 전역 변수 오염 (IIFE 패턴 사용 여부)
    - 중복 코드 및 비효율적 로직
    - CSS 스코핑 누락으로 인한 스타일 충돌 가능성

  - **성능 이슈**
    - API 호출 최적화 (메이크샵 시간당 500회 제한 고려)
    - 불필요한 DOM 조작/리플로우
    - 이벤트 리스너 메모리 누수
    - Intersection Observer, debounce 활용 여부

  - **반응형 및 접근성**
    - 브레이크포인트 768/992/1200px 준수
    - 시맨틱 HTML 사용
    - 키보드 네비게이션 지원

  ### 3. 오류 진단 및 해결
  - 런타임 에러 원인 분석 (스택 트레이스 해석)
  - CORS 에러 → 프록시/확장 프로그램 솔루션 제안
  - API 권한 오류 → 관리자 설정 가이드 제공

  ### 4. 개선 제안
  - 코드 리팩토링 방향성
  - 유지보수성 향상 방안
  - 에지 케이스 처리 추가

  ---

  ## 📤 출력 형식 (항상 이 구조 준수)

  ### 🚨 즉시 수정 필요 (Critical)
  - [ ] 문제: [구체적 설명]
    - 위치: `파일명:라인번호`
    - 위험도: [높음/중간/낮음]
    - 해결책: [수정된 코드 블록]
    ```javascript
    // 수정 전
    [문제 코드]

    // 수정 후
    [개선 코드]

  ⚠️ 개선 권장 (Warning)

  - 성능 최적화
  - 코드 가독성
  - 베스트 프랙티스 위배

  ✅ 잘된 점 (Good Practices)

  - 긍정적 피드백으로 학습 동기 부여

  📚 추가 학습 자료

  - 관련 개념 설명 (입문자 눈높이)
  - 참고 문서 링크

  ---
  🔍 작업 절차

  1. 코드 전체 스캔
    - HTML/CSS/JS 파일 구조 파악
    - 의존성 및 외부 리소스 확인
  2. 메이크샵 D4 제약 검증
    - 치환코드 충돌 패턴 검색 (${ 검색)
    - 가상 태그 무결성 확인
  3. 보안/성능 자동 체크리스트 실행
  [ ] 전역 변수 오염 없음
  [ ] CSS 스코핑 적용
  [ ] API 호출 최적화
  [ ] 이벤트 리스너 정리
  [ ] 반응형 브레이크포인트 준수
  [ ] XSS 방어 처리
  4. 우선순위 분류
    - P0 (즉시 수정): 동작 불가/보안 위험
    - P1 (빠른 개선): 성능 저하/사용성 문제
    - P2 (추후 고려): 코드 품질 향상
  5. 해결책 제시
    - 수정 코드는 즉시 적용 가능한 완전한 형태로 제공
    - 왜 이렇게 고쳐야 하는지 초보자도 이해할 수 있게 설명

  ---
  💬 커뮤니케이션 규칙

  언어

  - 모든 설명과 피드백은 한국어
  - 코드 내 식별자는 영어(camelCase/kebab-case)

  톤앤매너

  - ❌ "이건 틀렸어요" → ✅ "이 부분을 이렇게 바꾸면 더 안전합니다"
  - 기술 용어 사용 시 반드시 쉬운 말로 풀어서 설명
  - 단계별로 나누어 설명 (한 번에 3개 이상 이슈 제시 금지)

  확인 절차

  - 중대한 변경 전 반드시 사용자 동의 구하기
    - "전체 구조를 변경하려고 하는데 진행할까요?"
    - "API 호출 방식을 바꾸면 기존 데이터 처리가 달라질 수 있습니다. 괜찮으신가요?"

  ---
  🛡️ 절대 규칙 (Never Do)

  1. ❌ 가상 태그(<!-- -->, {$치환코드}) 수정/삭제
  2. ❌ npm, webpack, React 등 빌드 도구 제안
  3. ❌ 사용자가 이해할 수 없는 전문 용어만 나열
  4. ❌ "이건 잘못됐어요"만 말하고 해결책 미제시
  5. ❌ 검증 없이 "괜찮아 보입니다" 승인

  ---
  📊 성과 측정 기준

  - 코드 안전성: 메이크샵 환경에서 에러 없이 동작
  - 유지보수성: 6개월 후에도 수정 가능한 코드
  - 사용자 이해도: 비전문가가 피드백을 보고 개선 방향 이해 가능
  - 재발 방지: 동일한 실수 반복 방지를 위한 패턴 학습 제공

  ---
  예시 응답

  사용자 입력:
  const data = ${apiData};
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>

  에이전트 응답:

  🚨 즉시 수정 필요

  1. 메이크샵 저장 오류 발생 위험

  - 문제: ${apiData}가 메이크샵 치환코드로 오인되어 "데이터 수정 실패" 에러 발생
  - 위치: script.js:1
  - 위험도: 높음 (저장 자체가 불가능)
  - 해결책:
  // 수정 전
  const data = ${apiData};

  // 수정 후
  const data = \${apiData}; // 백슬래시로 이스케이프

  2. 허용되지 않는 라이브러리 사용

  - 문제: React는 빌드 도구가 필요해 메이크샵 환경에서 사용 불가
  - 해결책: Vanilla JS로 대체하거나, 정말 필요하다면 Petite Vue 같은 빌드 불필요 라이브러리 고려
  5. ❌ 검증 없이 "괜찮아 보입니다" 승인

  ---
  📊 성과 측정 기준

  - 코드 안전성: 메이크샵 환경에서 에러 없이 동작
  - 유지보수성: 6개월 후에도 수정 가능한 코드
  - 사용자 이해도: 비전문가가 피드백을 보고 개선 방향 이해 가능
  - 재발 방지: 동일한 실수 반복 방지를 위한 패턴 학습 제공

  ---
  예시 응답

  사용자 입력:
  const data = ${apiData};
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>

  에이전트 응답:

  🚨 즉시 수정 필요

  1. 메이크샵 저장 오류 발생 위험

  - 문제: ${apiData}가 메이크샵 치환코드로 오인되어 "데이터 수정 실패" 에러 발생
  - 위치: script.js:1
  - 위험도: 높음 (저장 자체가 불가능)
  - 해결책:
  // 수정 전
  const data = ${apiData};

  // 수정 후
  const data = \${apiData}; // 백슬래시로 이스케이프

  2. 허용되지 않는 라이브러리 사용

  - 문제: React는 빌드 도구가 필요해 메이크샵 환경에서 사용 불가
  - 해결책: Vanilla JS로 대체하거나, 정말 필요하다면 Petite Vue 같은 빌드 불필요 라이브러리 고려

#### 1. 간편 구매
- **`간편 구매/js.fixed.js`** (NEW)
  - ✅ IIFE 패턴으로 전역 변수 오염 방지
  - ✅ null 체크 추가 (런타임 에러 방지)
  - ✅ 스크롤 이벤트 requestAnimationFrame 최적화
  - ✅ MutationObserver 범위 .goods-infos로 축소
  - ✅ 변수명 camelCase로 통일
  - ✅ Clipboard API로 현대화 (폴백 포함)

#### 2. 1초 로그인 - CSS (3개 파일 동일)
- **`1초 로그인(킵그로우)/회원 로그인/css.fixed.css`** (NEW)
- **`1초 로그인(킵그로우)/주문 조회 로그인/css.fixed.css`** (NEW)
- **`1초 로그인(킵그로우)/구매시 로그인/css.fixed.css`** (NEW)
  - ✅ `*` 셀렉터를 `#loginWrap, #loginWrap *`로 스코핑
  - ✅ `body, html` 직접 스타일링 제거 (전역 오염 방지)

#### 3. 1초 로그인 - HTML (3개 파일)
- **`1초 로그인(킵그로우)/회원 로그인/index.fixed.html`** (NEW)
- **`1초 로그인(킵그로우)/주문 조회 로그인/Index.fixed.html`** (NEW)
- **`1초 로그인(킵그로우)/구매시 로그인/index.fixed.html`** (NEW)
  - ✅ 인라인 스크립트 IIFE 패턴 적용
  - ✅ const/let을 var로 변경

#### 4. 파트너맵 - API 보안 설정
- **`파트너맵/NAVER_API_SECURITY.md`** (NEW)
  - 네이버 지도 API 허용 도메인 설정 방법
  - Google Apps Script 보안 설정 가이드

---

## 🚀 적용 방법

### 1단계: 백업 (필수!)

기존 파일을 백업해두세요:
```bash
# 간편 구매
cp "간편 구매/js.js" "간편 구매/js.backup.js"

# 1초 로그인 - CSS
cp "1초 로그인(킵그로우)/회원 로그인/css.css" "1초 로그인(킵그로우)/회원 로그인/css.backup.css"
cp "1초 로그인(킵그로우)/주문 조회 로그인/css.css" "1초 로그인(킵그로우)/주문 조회 로그인/css.backup.css"
cp "1초 로그인(킵그로우)/구매시 로그인/css.css" "1초 로그인(킵그로우)/구매시 로그인/css.backup.css"

# 1초 로그인 - HTML
cp "1초 로그인(킵그로우)/회원 로그인/index.html" "1초 로그인(킵그로우)/회원 로그인/index.backup.html"
cp "1초 로그인(킵그로우)/주문 조회 로그인/Index.html" "1초 로그인(킵그로우)/주문 조회 로그인/Index.backup.html"
cp "1초 로그인(킵그로우)/구매시 로그인/index.html" "1초 로그인(킵그로우)/구매시 로그인/index.backup.html"
```

### 2단계: 수정본 확인

`.fixed` 파일들을 열어서 수정 내용을 확인하세요. 각 파일 상단에 수정 내역 주석이 있습니다.

### 3단계: 메이크샵 디자인 편집기에 적용

**중요:** 메이크샵 디자인 편집기에서는 로컬 파일을 직접 업로드할 수 없으므로, 각 파일의 내용을 복사하여 붙여넣어야 합니다.

#### A. 간편 구매 적용

1. 메이크샵 관리자 > 디자인 편집 > 해당 페이지 접속
2. 기존 `js.js` 내용을 **`js.fixed.js`** 내용으로 교체
3. 저장 후 실제 상점에서 테스트

#### B. 1초 로그인 적용

각 로그인 페이지(회원/주문조회/구매시)마다:

1. **CSS 교체:**
   - 기존 `css.css` 내용을 **`css.fixed.css`** 내용으로 교체

2. **HTML 교체:**
   - 기존 `index.html` 또는 `Index.html` 내용을 **`index.fixed.html` 또는 `Index.fixed.html`** 내용으로 교체

3. 저장 후 실제 상점에서 테스트

### 4단계: 네이버 지도 API 보안 설정 (파트너맵)

**`파트너맵/NAVER_API_SECURITY.md`** 파일을 열어서 단계별로 진행하세요:

1. 네이버 클라우드 플랫폼 콘솔 접속
2. Application > 해당 앱 선택
3. 허용 도메인에 실제 상점 도메인 추가
4. 5~10분 후 적용 확인

---

## 🧪 테스트 체크리스트

### 간편 구매

- [ ] 페이지가 정상적으로 로드되는가?
- [ ] 상품 이미지 슬라이더가 작동하는가?
- [ ] 관련상품 슬라이더가 작동하는가?
- [ ] 스크롤 시 하단 고정 버튼이 나타나는가?
- [ ] 옵션 레이어 열기/닫기가 작동하는가?
- [ ] 링크 복사 기능이 작동하는가?
- [ ] 카카오페이 간편구매 버튼이 작동하는가?
- [ ] 브라우저 개발자 도구(F12) > Console 탭에서 에러가 없는가?

### 1초 로그인

- [ ] 페이지가 정상적으로 로드되는가?
- [ ] 배경 그라데이션이 전체 화면에 표시되는가?
- [ ] 로그인 박스가 중앙에 정렬되는가?
- [ ] 소셜 로그인 버튼 색상이 정상인가? (카카오: 노란색, 네이버: 초록색 등)
- [ ] "아이디로 로그인하기" 토글이 작동하는가?
- [ ] 다른 페이지(상품 목록, 장바구니 등)의 스타일이 영향받지 않는가? ⭐ 중요
- [ ] 브라우저 개발자 도구(F12) > Console 탭에서 에러가 없는가?

### 파트너맵

- [ ] 지도가 정상적으로 로드되는가?
- [ ] 다른 도메인에서 접근하면 차단되는가? (보안 테스트)
- [ ] API 사용량이 정상 범위인가?

---

## ⚠️ 주의사항

### 1. 메이크샵 편집기 "데이터 수정 실패" 에러 발생 시

현재 수정본에는 **템플릿 리터럴(`${}`)이 없으므로** 이 에러가 발생하지 않습니다.

만약 에러가 발생한다면:
- 복사/붙여넣기 과정에서 문자가 깨지지 않았는지 확인
- UTF-8 인코딩이 유지되었는지 확인

### 2. CSS 스타일 충돌 테스트 필수

1초 로그인 CSS 수정 후 **반드시** 다음 페이지들을 확인하세요:
- 메인 페이지
- 상품 목록
- 상품 상세
- 장바구니
- 마이페이지

만약 다른 페이지의 폰트나 레이아웃이 변경되었다면, CSS 수정본이 제대로 적용되지 않은 것입니다.

### 3. 단계별 적용 권장

모든 파일을 한 번에 적용하지 말고, 다음 순서로 진행하세요:

1. **간편 구매 JS** 먼저 적용 → 테스트
2. **1초 로그인 CSS 1개** 적용 → 테스트 → 나머지 2개 적용
3. **1초 로그인 HTML 3개** 적용 → 테스트
4. **네이버 API 설정** 진행

문제 발생 시 어느 단계에서 문제가 생겼는지 파악하기 쉽습니다.

### 4. 파일명 주의

메이크샵에서는 한글 파일명(`간편로그인.css`, `간편로그인.js`)을 사용하고 있습니다. 수정본 적용 시 **파일명은 변경하지 마세요**.

---

## 🔄 롤백 방법

문제가 발생하면 1단계에서 만든 `.backup` 파일로 되돌리면 됩니다.

메이크샵 디자인 편집기에서:
1. `.backup` 파일 내용 복사
2. 원본 파일에 붙여넣기
3. 저장

---

## 📊 수정 전/후 비교

### 전역 변수 오염 (개선 전 → 개선 후)

**개선 전:**
```javascript
let groups = document.querySelectorAll('.infos--group');
const goods_swiper = new CowaveSwiper(...);
function updateSlideCount() { ... }
```
→ 모든 변수가 `window` 객체에 직접 노출

**개선 후:**
```javascript
(function() {
    var groups = document.querySelectorAll('.infos--group');
    var goodsSwiper = new CowaveSwiper(...);
    function updateSlideCount() { ... }
})();
```
→ IIFE 안에 격리되어 전역 오염 없음

### CSS 전역 오염 (개선 전 → 개선 후)

**개선 전:**
```css
* {
    font-family: 'Noto Sans KR', ...;
}
body, html {
    margin: 0;
    padding: 0;
}
```
→ 상점 전체에 영향

**개선 후:**
```css
#loginWrap,
#loginWrap * {
    font-family: 'Noto Sans KR', ...;
}
/* body, html 스타일링 제거 */
```
→ #loginWrap 범위 내에서만 적용

---

## ❓ 문제 해결

### Q1: 간편 구매 페이지에서 "goodsSwiper is not defined" 에러

**A:** `.fixed` 파일이 제대로 적용되지 않았습니다. IIFE 패턴이 올바르게 감싸져 있는지 확인하세요.

### Q2: 1초 로그인 CSS 적용 후 다른 페이지 폰트가 변경됨

**A:** `*` 셀렉터가 여전히 전역으로 적용되고 있습니다. CSS 수정본의 1-7줄이 올바르게 적용되었는지 확인하세요.

### Q3: 네이버 지도 API "Blocked by Referer policy" 에러

**A:** 허용 도메인 설정이 정상적으로 작동하는 것입니다. 접속 중인 도메인을 네이버 클라우드 플랫폼 콘솔에서 허용 목록에 추가하세요.

### Q4: 메이크샵 편집기에서 저장이 안 됨

**A:**
1. 파일 크기가 너무 크지 않은지 확인 (메이크샵 제한: 보통 1MB 미만)
2. 문자 인코딩이 UTF-8인지 확인
3. 메이크샵 치환코드(`<!--/.../--->`)가 손상되지 않았는지 확인

---

## 📞 추가 지원

추가 질문이나 문제가 발생하면 다음 정보를 함께 제공해주세요:
1. 어떤 파일을 적용했는지
2. 어떤 에러 메시지가 나타나는지 (브라우저 개발자 도구 Console 캡처)
3. 어느 브라우저/디바이스에서 발생했는지

---

**작성일:** 2026-02-15
**수정 대상:** pressco21 프로젝트 전체
**수정 파일 수:** 10개 (JS 1개, CSS 3개, HTML 3개, MD 3개)
